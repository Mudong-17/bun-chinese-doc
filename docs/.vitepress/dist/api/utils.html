<!DOCTYPE html>
<html lang="en-US" dir="ltr">
  <head>
    <meta charset="utf-8">
    <meta name="viewport" content="width=device-width,initial-scale=1">
    <title>Utils | Bun 中文文档</title>
    <meta name="description" content="Bun 中文文档">
    <link rel="preload stylesheet" href="/assets/style.0e7a6ed2.css" as="style">
    
    <script type="module" src="/assets/app.399bb3dd.js"></script>
    <link rel="preload" href="/assets/inter-roman-latin.2ed14f66.woff2" as="font" type="font/woff2" crossorigin="">
    <link rel="modulepreload" href="/assets/chunks/framework.33544f09.js">
    <link rel="modulepreload" href="/assets/chunks/theme.1e445b75.js">
    <link rel="modulepreload" href="/assets/api_utils.md.06822ad6.lean.js">
    <script id="check-dark-mode">(()=>{const e=localStorage.getItem("vitepress-theme-appearance")||"auto",a=window.matchMedia("(prefers-color-scheme: dark)").matches;(!e||e==="auto"?a:e==="dark")&&document.documentElement.classList.add("dark")})();</script>
    <script id="check-mac-os">document.documentElement.classList.toggle("mac",/Mac|iPhone|iPod|iPad/i.test(navigator.platform));</script>
  </head>
  <body>
    <div id="app"><div class="Layout" data-v-95ddf855><!--[--><!--]--><!--[--><span tabindex="-1" data-v-636d6b92></span><a href="#VPContent" class="VPSkipLink visually-hidden" data-v-636d6b92> Skip to content </a><!--]--><!----><header class="VPNav" data-v-95ddf855 data-v-0790fcde><div class="VPNavBar has-sidebar" data-v-0790fcde data-v-cb40bece><div class="container" data-v-cb40bece><div class="title" data-v-cb40bece><div class="VPNavBarTitle has-sidebar" data-v-cb40bece data-v-8104aeb6><a class="title" href="/" data-v-8104aeb6><!--[--><!--]--><!----><!--[-->Bun 中文文档<!--]--><!--[--><!--]--></a></div></div><div class="content" data-v-cb40bece><div class="curtain" data-v-cb40bece></div><div class="content-body" data-v-cb40bece><!--[--><!--]--><div class="VPNavBarSearch search" data-v-cb40bece><!----></div><nav aria-labelledby="main-nav-aria-label" class="VPNavBarMenu menu" data-v-cb40bece data-v-f716060d><span id="main-nav-aria-label" class="visually-hidden" data-v-f716060d>Main Navigation</span><!--[--><!--[--><a class="VPLink link VPNavBarMenuLink" href="/" tabindex="0" data-v-f716060d data-v-f8f825d6><!--[--><span data-v-f8f825d6>Home</span><!--]--></a><!--]--><!--[--><a class="VPLink link VPNavBarMenuLink" href="/what-is-bun.html" tabindex="0" data-v-f716060d data-v-f8f825d6><!--[--><span data-v-f8f825d6>Docs</span><!--]--></a><!--]--><!--]--></nav><!----><div class="VPNavBarAppearance appearance" data-v-cb40bece data-v-9abe0e7b><button class="VPSwitch VPSwitchAppearance" type="button" role="switch" title="toggle dark mode" aria-checked="false" data-v-9abe0e7b data-v-aa41776a data-v-f5518534><span class="check" data-v-f5518534><span class="icon" data-v-f5518534><!--[--><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" viewbox="0 0 24 24" class="sun" data-v-aa41776a><path d="M12,18c-3.3,0-6-2.7-6-6s2.7-6,6-6s6,2.7,6,6S15.3,18,12,18zM12,8c-2.2,0-4,1.8-4,4c0,2.2,1.8,4,4,4c2.2,0,4-1.8,4-4C16,9.8,14.2,8,12,8z"></path><path d="M12,4c-0.6,0-1-0.4-1-1V1c0-0.6,0.4-1,1-1s1,0.4,1,1v2C13,3.6,12.6,4,12,4z"></path><path d="M12,24c-0.6,0-1-0.4-1-1v-2c0-0.6,0.4-1,1-1s1,0.4,1,1v2C13,23.6,12.6,24,12,24z"></path><path d="M5.6,6.6c-0.3,0-0.5-0.1-0.7-0.3L3.5,4.9c-0.4-0.4-0.4-1,0-1.4s1-0.4,1.4,0l1.4,1.4c0.4,0.4,0.4,1,0,1.4C6.2,6.5,5.9,6.6,5.6,6.6z"></path><path d="M19.8,20.8c-0.3,0-0.5-0.1-0.7-0.3l-1.4-1.4c-0.4-0.4-0.4-1,0-1.4s1-0.4,1.4,0l1.4,1.4c0.4,0.4,0.4,1,0,1.4C20.3,20.7,20,20.8,19.8,20.8z"></path><path d="M3,13H1c-0.6,0-1-0.4-1-1s0.4-1,1-1h2c0.6,0,1,0.4,1,1S3.6,13,3,13z"></path><path d="M23,13h-2c-0.6,0-1-0.4-1-1s0.4-1,1-1h2c0.6,0,1,0.4,1,1S23.6,13,23,13z"></path><path d="M4.2,20.8c-0.3,0-0.5-0.1-0.7-0.3c-0.4-0.4-0.4-1,0-1.4l1.4-1.4c0.4-0.4,1-0.4,1.4,0s0.4,1,0,1.4l-1.4,1.4C4.7,20.7,4.5,20.8,4.2,20.8z"></path><path d="M18.4,6.6c-0.3,0-0.5-0.1-0.7-0.3c-0.4-0.4-0.4-1,0-1.4l1.4-1.4c0.4-0.4,1-0.4,1.4,0s0.4,1,0,1.4l-1.4,1.4C18.9,6.5,18.6,6.6,18.4,6.6z"></path></svg><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" viewbox="0 0 24 24" class="moon" data-v-aa41776a><path d="M12.1,22c-0.3,0-0.6,0-0.9,0c-5.5-0.5-9.5-5.4-9-10.9c0.4-4.8,4.2-8.6,9-9c0.4,0,0.8,0.2,1,0.5c0.2,0.3,0.2,0.8-0.1,1.1c-2,2.7-1.4,6.4,1.3,8.4c2.1,1.6,5,1.6,7.1,0c0.3-0.2,0.7-0.3,1.1-0.1c0.3,0.2,0.5,0.6,0.5,1c-0.2,2.7-1.5,5.1-3.6,6.8C16.6,21.2,14.4,22,12.1,22zM9.3,4.4c-2.9,1-5,3.6-5.2,6.8c-0.4,4.4,2.8,8.3,7.2,8.7c2.1,0.2,4.2-0.4,5.8-1.8c1.1-0.9,1.9-2.1,2.4-3.4c-2.5,0.9-5.3,0.5-7.5-1.1C9.2,11.4,8.1,7.7,9.3,4.4z"></path></svg><!--]--></span></span></button></div><!----><div class="VPFlyout VPNavBarExtra extra" data-v-cb40bece data-v-18f9ff86 data-v-0ca3f6b7><button type="button" class="button" aria-haspopup="true" aria-expanded="false" aria-label="extra navigation" data-v-0ca3f6b7><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" viewbox="0 0 24 24" class="icon" data-v-0ca3f6b7><circle cx="12" cy="12" r="2"></circle><circle cx="19" cy="12" r="2"></circle><circle cx="5" cy="12" r="2"></circle></svg></button><div class="menu" data-v-0ca3f6b7><div class="VPMenu" data-v-0ca3f6b7 data-v-4a58d234><!----><!--[--><!--[--><!----><div class="group" data-v-18f9ff86><div class="item appearance" data-v-18f9ff86><p class="label" data-v-18f9ff86>Appearance</p><div class="appearance-action" data-v-18f9ff86><button class="VPSwitch VPSwitchAppearance" type="button" role="switch" title="toggle dark mode" aria-checked="false" data-v-18f9ff86 data-v-aa41776a data-v-f5518534><span class="check" data-v-f5518534><span class="icon" data-v-f5518534><!--[--><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" viewbox="0 0 24 24" class="sun" data-v-aa41776a><path d="M12,18c-3.3,0-6-2.7-6-6s2.7-6,6-6s6,2.7,6,6S15.3,18,12,18zM12,8c-2.2,0-4,1.8-4,4c0,2.2,1.8,4,4,4c2.2,0,4-1.8,4-4C16,9.8,14.2,8,12,8z"></path><path d="M12,4c-0.6,0-1-0.4-1-1V1c0-0.6,0.4-1,1-1s1,0.4,1,1v2C13,3.6,12.6,4,12,4z"></path><path d="M12,24c-0.6,0-1-0.4-1-1v-2c0-0.6,0.4-1,1-1s1,0.4,1,1v2C13,23.6,12.6,24,12,24z"></path><path d="M5.6,6.6c-0.3,0-0.5-0.1-0.7-0.3L3.5,4.9c-0.4-0.4-0.4-1,0-1.4s1-0.4,1.4,0l1.4,1.4c0.4,0.4,0.4,1,0,1.4C6.2,6.5,5.9,6.6,5.6,6.6z"></path><path d="M19.8,20.8c-0.3,0-0.5-0.1-0.7-0.3l-1.4-1.4c-0.4-0.4-0.4-1,0-1.4s1-0.4,1.4,0l1.4,1.4c0.4,0.4,0.4,1,0,1.4C20.3,20.7,20,20.8,19.8,20.8z"></path><path d="M3,13H1c-0.6,0-1-0.4-1-1s0.4-1,1-1h2c0.6,0,1,0.4,1,1S3.6,13,3,13z"></path><path d="M23,13h-2c-0.6,0-1-0.4-1-1s0.4-1,1-1h2c0.6,0,1,0.4,1,1S23.6,13,23,13z"></path><path d="M4.2,20.8c-0.3,0-0.5-0.1-0.7-0.3c-0.4-0.4-0.4-1,0-1.4l1.4-1.4c0.4-0.4,1-0.4,1.4,0s0.4,1,0,1.4l-1.4,1.4C4.7,20.7,4.5,20.8,4.2,20.8z"></path><path d="M18.4,6.6c-0.3,0-0.5-0.1-0.7-0.3c-0.4-0.4-0.4-1,0-1.4l1.4-1.4c0.4-0.4,1-0.4,1.4,0s0.4,1,0,1.4l-1.4,1.4C18.9,6.5,18.6,6.6,18.4,6.6z"></path></svg><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" viewbox="0 0 24 24" class="moon" data-v-aa41776a><path d="M12.1,22c-0.3,0-0.6,0-0.9,0c-5.5-0.5-9.5-5.4-9-10.9c0.4-4.8,4.2-8.6,9-9c0.4,0,0.8,0.2,1,0.5c0.2,0.3,0.2,0.8-0.1,1.1c-2,2.7-1.4,6.4,1.3,8.4c2.1,1.6,5,1.6,7.1,0c0.3-0.2,0.7-0.3,1.1-0.1c0.3,0.2,0.5,0.6,0.5,1c-0.2,2.7-1.5,5.1-3.6,6.8C16.6,21.2,14.4,22,12.1,22zM9.3,4.4c-2.9,1-5,3.6-5.2,6.8c-0.4,4.4,2.8,8.3,7.2,8.7c2.1,0.2,4.2-0.4,5.8-1.8c1.1-0.9,1.9-2.1,2.4-3.4c-2.5,0.9-5.3,0.5-7.5-1.1C9.2,11.4,8.1,7.7,9.3,4.4z"></path></svg><!--]--></span></span></button></div></div></div><!----><!--]--><!--]--></div></div></div><!--[--><!--]--><button type="button" class="VPNavBarHamburger hamburger" aria-label="mobile navigation" aria-expanded="false" aria-controls="VPNavScreen" data-v-cb40bece data-v-805a0308><span class="container" data-v-805a0308><span class="top" data-v-805a0308></span><span class="middle" data-v-805a0308></span><span class="bottom" data-v-805a0308></span></span></button></div></div></div></div><!----></header><div class="VPLocalNav reached-top" data-v-95ddf855 data-v-b587166c><button class="menu" aria-expanded="false" aria-controls="VPSidebarNav" data-v-b587166c><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" viewbox="0 0 24 24" class="menu-icon" data-v-b587166c><path d="M17,11H3c-0.6,0-1-0.4-1-1s0.4-1,1-1h14c0.6,0,1,0.4,1,1S17.6,11,17,11z"></path><path d="M21,7H3C2.4,7,2,6.6,2,6s0.4-1,1-1h18c0.6,0,1,0.4,1,1S21.6,7,21,7z"></path><path d="M21,15H3c-0.6,0-1-0.4-1-1s0.4-1,1-1h18c0.6,0,1,0.4,1,1S21.6,15,21,15z"></path><path d="M17,19H3c-0.6,0-1-0.4-1-1s0.4-1,1-1h14c0.6,0,1,0.4,1,1S17.6,19,17,19z"></path></svg><span class="menu-text" data-v-b587166c>Menu</span></button><div class="VPLocalNavOutlineDropdown" style="--vp-vh:0px;" data-v-b587166c data-v-ff16dce8><button data-v-ff16dce8>Return to top</button><!----></div></div><aside class="VPSidebar" data-v-95ddf855 data-v-7d181c84><div class="curtain" data-v-7d181c84></div><nav class="nav" id="VPSidebarNav" aria-labelledby="sidebar-aria-label" tabindex="-1" data-v-7d181c84><span class="visually-hidden" id="sidebar-aria-label" data-v-7d181c84> Sidebar Navigation </span><!--[--><!--]--><!--[--><div class="group" data-v-7d181c84><section class="VPSidebarItem level-0" data-v-7d181c84 data-v-ab6c6bfc><div class="item" role="button" tabindex="0" data-v-ab6c6bfc><div class="indicator" data-v-ab6c6bfc></div><h2 class="text" data-v-ab6c6bfc>Intro-介绍</h2><!----></div><div class="items" data-v-ab6c6bfc><!--[--><div class="VPSidebarItem level-1 is-link" data-v-ab6c6bfc data-v-ab6c6bfc><div class="item" data-v-ab6c6bfc><div class="indicator" data-v-ab6c6bfc></div><a class="VPLink link link" href="/what-is-bun.html" data-v-ab6c6bfc><!--[--><p class="text" data-v-ab6c6bfc>What is Bun</p><!--]--></a><!----></div><!----></div><div class="VPSidebarItem level-1 is-link" data-v-ab6c6bfc data-v-ab6c6bfc><div class="item" data-v-ab6c6bfc><div class="indicator" data-v-ab6c6bfc></div><a class="VPLink link link" href="/installation.html" data-v-ab6c6bfc><!--[--><p class="text" data-v-ab6c6bfc>Installation</p><!--]--></a><!----></div><!----></div><div class="VPSidebarItem level-1 is-link" data-v-ab6c6bfc data-v-ab6c6bfc><div class="item" data-v-ab6c6bfc><div class="indicator" data-v-ab6c6bfc></div><a class="VPLink link link" href="/quickstart.html" data-v-ab6c6bfc><!--[--><p class="text" data-v-ab6c6bfc>Quickstart</p><!--]--></a><!----></div><!----></div><div class="VPSidebarItem level-1 is-link" data-v-ab6c6bfc data-v-ab6c6bfc><div class="item" data-v-ab6c6bfc><div class="indicator" data-v-ab6c6bfc></div><a class="VPLink link link" href="/typescript.html" data-v-ab6c6bfc><!--[--><p class="text" data-v-ab6c6bfc>TypeScript</p><!--]--></a><!----></div><!----></div><div class="VPSidebarItem level-1 is-link" data-v-ab6c6bfc data-v-ab6c6bfc><div class="item" data-v-ab6c6bfc><div class="indicator" data-v-ab6c6bfc></div><a class="VPLink link link" href="/templates.html" data-v-ab6c6bfc><!--[--><p class="text" data-v-ab6c6bfc>Templates</p><!--]--></a><!----></div><!----></div><!--]--></div></section></div><div class="group" data-v-7d181c84><section class="VPSidebarItem level-0" data-v-7d181c84 data-v-ab6c6bfc><div class="item" role="button" tabindex="0" data-v-ab6c6bfc><div class="indicator" data-v-ab6c6bfc></div><h2 class="text" data-v-ab6c6bfc>Runtime-运行时</h2><!----></div><div class="items" data-v-ab6c6bfc><!--[--><div class="VPSidebarItem level-1 is-link" data-v-ab6c6bfc data-v-ab6c6bfc><div class="item" data-v-ab6c6bfc><div class="indicator" data-v-ab6c6bfc></div><a class="VPLink link link" href="/cli/run.html" data-v-ab6c6bfc><!--[--><p class="text" data-v-ab6c6bfc>bun run</p><!--]--></a><!----></div><!----></div><div class="VPSidebarItem level-1 is-link" data-v-ab6c6bfc data-v-ab6c6bfc><div class="item" data-v-ab6c6bfc><div class="indicator" data-v-ab6c6bfc></div><a class="VPLink link link" href="/runtime/loaders.html" data-v-ab6c6bfc><!--[--><p class="text" data-v-ab6c6bfc>File types</p><!--]--></a><!----></div><!----></div><div class="VPSidebarItem level-1 is-link" data-v-ab6c6bfc data-v-ab6c6bfc><div class="item" data-v-ab6c6bfc><div class="indicator" data-v-ab6c6bfc></div><a class="VPLink link link" href="/runtime/typescript.html" data-v-ab6c6bfc><!--[--><p class="text" data-v-ab6c6bfc>TypeScript</p><!--]--></a><!----></div><!----></div><div class="VPSidebarItem level-1 is-link" data-v-ab6c6bfc data-v-ab6c6bfc><div class="item" data-v-ab6c6bfc><div class="indicator" data-v-ab6c6bfc></div><a class="VPLink link link" href="/runtime/jsx.html" data-v-ab6c6bfc><!--[--><p class="text" data-v-ab6c6bfc>JSX</p><!--]--></a><!----></div><!----></div><div class="VPSidebarItem level-1 is-link" data-v-ab6c6bfc data-v-ab6c6bfc><div class="item" data-v-ab6c6bfc><div class="indicator" data-v-ab6c6bfc></div><a class="VPLink link link" href="/runtime/env.html" data-v-ab6c6bfc><!--[--><p class="text" data-v-ab6c6bfc>Environment variables</p><!--]--></a><!----></div><!----></div><div class="VPSidebarItem level-1 is-link" data-v-ab6c6bfc data-v-ab6c6bfc><div class="item" data-v-ab6c6bfc><div class="indicator" data-v-ab6c6bfc></div><a class="VPLink link link" href="/runtime/bun-apis.html" data-v-ab6c6bfc><!--[--><p class="text" data-v-ab6c6bfc>Bun APIs</p><!--]--></a><!----></div><!----></div><div class="VPSidebarItem level-1 is-link" data-v-ab6c6bfc data-v-ab6c6bfc><div class="item" data-v-ab6c6bfc><div class="indicator" data-v-ab6c6bfc></div><a class="VPLink link link" href="/runtime/web-api.html" data-v-ab6c6bfc><!--[--><p class="text" data-v-ab6c6bfc>Web APIs</p><!--]--></a><!----></div><!----></div><div class="VPSidebarItem level-1 is-link" data-v-ab6c6bfc data-v-ab6c6bfc><div class="item" data-v-ab6c6bfc><div class="indicator" data-v-ab6c6bfc></div><a class="VPLink link link" href="/runtime/nodejs-api.html" data-v-ab6c6bfc><!--[--><p class="text" data-v-ab6c6bfc>Node.js compatibility</p><!--]--></a><!----></div><!----></div><div class="VPSidebarItem level-1 is-link" data-v-ab6c6bfc data-v-ab6c6bfc><div class="item" data-v-ab6c6bfc><div class="indicator" data-v-ab6c6bfc></div><a class="VPLink link link" href="/runtime/plugins.html" data-v-ab6c6bfc><!--[--><p class="text" data-v-ab6c6bfc>Plugins</p><!--]--></a><!----></div><!----></div><div class="VPSidebarItem level-1 is-link" data-v-ab6c6bfc data-v-ab6c6bfc><div class="item" data-v-ab6c6bfc><div class="indicator" data-v-ab6c6bfc></div><a class="VPLink link link" href="/runtime/hot.html" data-v-ab6c6bfc><!--[--><p class="text" data-v-ab6c6bfc>Watch mode</p><!--]--></a><!----></div><!----></div><div class="VPSidebarItem level-1 is-link" data-v-ab6c6bfc data-v-ab6c6bfc><div class="item" data-v-ab6c6bfc><div class="indicator" data-v-ab6c6bfc></div><a class="VPLink link link" href="/runtime/modules.html" data-v-ab6c6bfc><!--[--><p class="text" data-v-ab6c6bfc>Module resolution</p><!--]--></a><!----></div><!----></div><div class="VPSidebarItem level-1 is-link" data-v-ab6c6bfc data-v-ab6c6bfc><div class="item" data-v-ab6c6bfc><div class="indicator" data-v-ab6c6bfc></div><a class="VPLink link link" href="/runtime/autoimport.html" data-v-ab6c6bfc><!--[--><p class="text" data-v-ab6c6bfc>Auto-install</p><!--]--></a><!----></div><!----></div><div class="VPSidebarItem level-1 is-link" data-v-ab6c6bfc data-v-ab6c6bfc><div class="item" data-v-ab6c6bfc><div class="indicator" data-v-ab6c6bfc></div><a class="VPLink link link" href="/runtime/bunfig.html" data-v-ab6c6bfc><!--[--><p class="text" data-v-ab6c6bfc>bunfig.toml</p><!--]--></a><!----></div><!----></div><div class="VPSidebarItem level-1 is-link" data-v-ab6c6bfc data-v-ab6c6bfc><div class="item" data-v-ab6c6bfc><div class="indicator" data-v-ab6c6bfc></div><a class="VPLink link link" href="/runtime/debugger.html" data-v-ab6c6bfc><!--[--><p class="text" data-v-ab6c6bfc>Debugger</p><!--]--></a><!----></div><!----></div><!--]--></div></section></div><div class="group" data-v-7d181c84><section class="VPSidebarItem level-0" data-v-7d181c84 data-v-ab6c6bfc><div class="item" role="button" tabindex="0" data-v-ab6c6bfc><div class="indicator" data-v-ab6c6bfc></div><h2 class="text" data-v-ab6c6bfc>Package manager</h2><!----></div><div class="items" data-v-ab6c6bfc><!--[--><div class="VPSidebarItem level-1 is-link" data-v-ab6c6bfc data-v-ab6c6bfc><div class="item" data-v-ab6c6bfc><div class="indicator" data-v-ab6c6bfc></div><a class="VPLink link link" href="/cli/install.html" data-v-ab6c6bfc><!--[--><p class="text" data-v-ab6c6bfc>bun install</p><!--]--></a><!----></div><!----></div><div class="VPSidebarItem level-1 is-link" data-v-ab6c6bfc data-v-ab6c6bfc><div class="item" data-v-ab6c6bfc><div class="indicator" data-v-ab6c6bfc></div><a class="VPLink link link" href="/install/cache.html" data-v-ab6c6bfc><!--[--><p class="text" data-v-ab6c6bfc>Global cache</p><!--]--></a><!----></div><!----></div><div class="VPSidebarItem level-1 is-link" data-v-ab6c6bfc data-v-ab6c6bfc><div class="item" data-v-ab6c6bfc><div class="indicator" data-v-ab6c6bfc></div><a class="VPLink link link" href="/install/workspaces.html" data-v-ab6c6bfc><!--[--><p class="text" data-v-ab6c6bfc>Workspaces</p><!--]--></a><!----></div><!----></div><div class="VPSidebarItem level-1 is-link" data-v-ab6c6bfc data-v-ab6c6bfc><div class="item" data-v-ab6c6bfc><div class="indicator" data-v-ab6c6bfc></div><a class="VPLink link link" href="/install/lockfile.html" data-v-ab6c6bfc><!--[--><p class="text" data-v-ab6c6bfc>Lockfile</p><!--]--></a><!----></div><!----></div><div class="VPSidebarItem level-1 is-link" data-v-ab6c6bfc data-v-ab6c6bfc><div class="item" data-v-ab6c6bfc><div class="indicator" data-v-ab6c6bfc></div><a class="VPLink link link" href="/install/registries.html" data-v-ab6c6bfc><!--[--><p class="text" data-v-ab6c6bfc>Scopes and registries</p><!--]--></a><!----></div><!----></div><div class="VPSidebarItem level-1 is-link" data-v-ab6c6bfc data-v-ab6c6bfc><div class="item" data-v-ab6c6bfc><div class="indicator" data-v-ab6c6bfc></div><a class="VPLink link link" href="/install/utilities.html" data-v-ab6c6bfc><!--[--><p class="text" data-v-ab6c6bfc>Utilities</p><!--]--></a><!----></div><!----></div><!--]--></div></section></div><div class="group" data-v-7d181c84><section class="VPSidebarItem level-0" data-v-7d181c84 data-v-ab6c6bfc><div class="item" role="button" tabindex="0" data-v-ab6c6bfc><div class="indicator" data-v-ab6c6bfc></div><h2 class="text" data-v-ab6c6bfc>Bundler</h2><!----></div><div class="items" data-v-ab6c6bfc><!--[--><div class="VPSidebarItem level-1 is-link" data-v-ab6c6bfc data-v-ab6c6bfc><div class="item" data-v-ab6c6bfc><div class="indicator" data-v-ab6c6bfc></div><a class="VPLink link link" href="/bundler/index.html" data-v-ab6c6bfc><!--[--><p class="text" data-v-ab6c6bfc>Bun.build</p><!--]--></a><!----></div><!----></div><div class="VPSidebarItem level-1 is-link" data-v-ab6c6bfc data-v-ab6c6bfc><div class="item" data-v-ab6c6bfc><div class="indicator" data-v-ab6c6bfc></div><a class="VPLink link link" href="/bundler/loaders.html" data-v-ab6c6bfc><!--[--><p class="text" data-v-ab6c6bfc>Loaders</p><!--]--></a><!----></div><!----></div><div class="VPSidebarItem level-1 is-link" data-v-ab6c6bfc data-v-ab6c6bfc><div class="item" data-v-ab6c6bfc><div class="indicator" data-v-ab6c6bfc></div><a class="VPLink link link" href="/bundler/plugins.html" data-v-ab6c6bfc><!--[--><p class="text" data-v-ab6c6bfc>Plugins</p><!--]--></a><!----></div><!----></div><div class="VPSidebarItem level-1 is-link" data-v-ab6c6bfc data-v-ab6c6bfc><div class="item" data-v-ab6c6bfc><div class="indicator" data-v-ab6c6bfc></div><a class="VPLink link link" href="/bundler/executables.html" data-v-ab6c6bfc><!--[--><p class="text" data-v-ab6c6bfc>Executables</p><!--]--></a><!----></div><!----></div><div class="VPSidebarItem level-1 is-link" data-v-ab6c6bfc data-v-ab6c6bfc><div class="item" data-v-ab6c6bfc><div class="indicator" data-v-ab6c6bfc></div><a class="VPLink link link" href="/bundler/macros.html" data-v-ab6c6bfc><!--[--><p class="text" data-v-ab6c6bfc>Macros</p><!--]--></a><!----></div><!----></div><div class="VPSidebarItem level-1 is-link" data-v-ab6c6bfc data-v-ab6c6bfc><div class="item" data-v-ab6c6bfc><div class="indicator" data-v-ab6c6bfc></div><a class="VPLink link link" href="/bundler/vs-esbuild.html" data-v-ab6c6bfc><!--[--><p class="text" data-v-ab6c6bfc>vs esbuild</p><!--]--></a><!----></div><!----></div><!--]--></div></section></div><div class="group" data-v-7d181c84><section class="VPSidebarItem level-0" data-v-7d181c84 data-v-ab6c6bfc><div class="item" role="button" tabindex="0" data-v-ab6c6bfc><div class="indicator" data-v-ab6c6bfc></div><h2 class="text" data-v-ab6c6bfc>Test runner</h2><!----></div><div class="items" data-v-ab6c6bfc><!--[--><div class="VPSidebarItem level-1 is-link" data-v-ab6c6bfc data-v-ab6c6bfc><div class="item" data-v-ab6c6bfc><div class="indicator" data-v-ab6c6bfc></div><a class="VPLink link link" href="/cli/test.html" data-v-ab6c6bfc><!--[--><p class="text" data-v-ab6c6bfc>bun test</p><!--]--></a><!----></div><!----></div><div class="VPSidebarItem level-1 is-link" data-v-ab6c6bfc data-v-ab6c6bfc><div class="item" data-v-ab6c6bfc><div class="indicator" data-v-ab6c6bfc></div><a class="VPLink link link" href="/test/writing.html" data-v-ab6c6bfc><!--[--><p class="text" data-v-ab6c6bfc>Writing tests</p><!--]--></a><!----></div><!----></div><div class="VPSidebarItem level-1 is-link" data-v-ab6c6bfc data-v-ab6c6bfc><div class="item" data-v-ab6c6bfc><div class="indicator" data-v-ab6c6bfc></div><a class="VPLink link link" href="/test/hot.html" data-v-ab6c6bfc><!--[--><p class="text" data-v-ab6c6bfc>Watch mode</p><!--]--></a><!----></div><!----></div><div class="VPSidebarItem level-1 is-link" data-v-ab6c6bfc data-v-ab6c6bfc><div class="item" data-v-ab6c6bfc><div class="indicator" data-v-ab6c6bfc></div><a class="VPLink link link" href="/test/lifecycle.html" data-v-ab6c6bfc><!--[--><p class="text" data-v-ab6c6bfc>Lifecycle hooks</p><!--]--></a><!----></div><!----></div><div class="VPSidebarItem level-1 is-link" data-v-ab6c6bfc data-v-ab6c6bfc><div class="item" data-v-ab6c6bfc><div class="indicator" data-v-ab6c6bfc></div><a class="VPLink link link" href="/test/mocks.html" data-v-ab6c6bfc><!--[--><p class="text" data-v-ab6c6bfc>Mocks</p><!--]--></a><!----></div><!----></div><div class="VPSidebarItem level-1 is-link" data-v-ab6c6bfc data-v-ab6c6bfc><div class="item" data-v-ab6c6bfc><div class="indicator" data-v-ab6c6bfc></div><a class="VPLink link link" href="/test/snapshots.html" data-v-ab6c6bfc><!--[--><p class="text" data-v-ab6c6bfc>Snapshots</p><!--]--></a><!----></div><!----></div><div class="VPSidebarItem level-1 is-link" data-v-ab6c6bfc data-v-ab6c6bfc><div class="item" data-v-ab6c6bfc><div class="indicator" data-v-ab6c6bfc></div><a class="VPLink link link" href="/test/time.html" data-v-ab6c6bfc><!--[--><p class="text" data-v-ab6c6bfc>Dates and times</p><!--]--></a><!----></div><!----></div><div class="VPSidebarItem level-1 is-link" data-v-ab6c6bfc data-v-ab6c6bfc><div class="item" data-v-ab6c6bfc><div class="indicator" data-v-ab6c6bfc></div><a class="VPLink link link" href="/test/dom.html" data-v-ab6c6bfc><!--[--><p class="text" data-v-ab6c6bfc>DOM testing</p><!--]--></a><!----></div><!----></div><div class="VPSidebarItem level-1 is-link" data-v-ab6c6bfc data-v-ab6c6bfc><div class="item" data-v-ab6c6bfc><div class="indicator" data-v-ab6c6bfc></div><a class="VPLink link link" href="/test/coverage.html" data-v-ab6c6bfc><!--[--><p class="text" data-v-ab6c6bfc>Code coverage</p><!--]--></a><!----></div><!----></div><!--]--></div></section></div><div class="group" data-v-7d181c84><section class="VPSidebarItem level-0" data-v-7d181c84 data-v-ab6c6bfc><div class="item" role="button" tabindex="0" data-v-ab6c6bfc><div class="indicator" data-v-ab6c6bfc></div><h2 class="text" data-v-ab6c6bfc>Package runner</h2><!----></div><div class="items" data-v-ab6c6bfc><!--[--><div class="VPSidebarItem level-1 is-link" data-v-ab6c6bfc data-v-ab6c6bfc><div class="item" data-v-ab6c6bfc><div class="indicator" data-v-ab6c6bfc></div><a class="VPLink link link" href="/cli/bunx.html" data-v-ab6c6bfc><!--[--><p class="text" data-v-ab6c6bfc>bunx</p><!--]--></a><!----></div><!----></div><!--]--></div></section></div><div class="group" data-v-7d181c84><section class="VPSidebarItem level-0 has-active" data-v-7d181c84 data-v-ab6c6bfc><div class="item" role="button" tabindex="0" data-v-ab6c6bfc><div class="indicator" data-v-ab6c6bfc></div><h2 class="text" data-v-ab6c6bfc>API</h2><!----></div><div class="items" data-v-ab6c6bfc><!--[--><div class="VPSidebarItem level-1 is-link" data-v-ab6c6bfc data-v-ab6c6bfc><div class="item" data-v-ab6c6bfc><div class="indicator" data-v-ab6c6bfc></div><a class="VPLink link link" href="/api/http.html" data-v-ab6c6bfc><!--[--><p class="text" data-v-ab6c6bfc>HTTP server</p><!--]--></a><!----></div><!----></div><div class="VPSidebarItem level-1 is-link" data-v-ab6c6bfc data-v-ab6c6bfc><div class="item" data-v-ab6c6bfc><div class="indicator" data-v-ab6c6bfc></div><a class="VPLink link link" href="/api/websockets.html" data-v-ab6c6bfc><!--[--><p class="text" data-v-ab6c6bfc>WebSockets</p><!--]--></a><!----></div><!----></div><div class="VPSidebarItem level-1 is-link" data-v-ab6c6bfc data-v-ab6c6bfc><div class="item" data-v-ab6c6bfc><div class="indicator" data-v-ab6c6bfc></div><a class="VPLink link link" href="/api/workers.html" data-v-ab6c6bfc><!--[--><p class="text" data-v-ab6c6bfc>Workers</p><!--]--></a><!----></div><!----></div><div class="VPSidebarItem level-1 is-link" data-v-ab6c6bfc data-v-ab6c6bfc><div class="item" data-v-ab6c6bfc><div class="indicator" data-v-ab6c6bfc></div><a class="VPLink link link" href="/api/binary-data.html" data-v-ab6c6bfc><!--[--><p class="text" data-v-ab6c6bfc>Binary data</p><!--]--></a><!----></div><!----></div><div class="VPSidebarItem level-1 is-link" data-v-ab6c6bfc data-v-ab6c6bfc><div class="item" data-v-ab6c6bfc><div class="indicator" data-v-ab6c6bfc></div><a class="VPLink link link" href="/api/streams.html" data-v-ab6c6bfc><!--[--><p class="text" data-v-ab6c6bfc>Streams</p><!--]--></a><!----></div><!----></div><div class="VPSidebarItem level-1 is-link" data-v-ab6c6bfc data-v-ab6c6bfc><div class="item" data-v-ab6c6bfc><div class="indicator" data-v-ab6c6bfc></div><a class="VPLink link link" href="/api/file-io.html" data-v-ab6c6bfc><!--[--><p class="text" data-v-ab6c6bfc>File I/O</p><!--]--></a><!----></div><!----></div><div class="VPSidebarItem level-1 is-link" data-v-ab6c6bfc data-v-ab6c6bfc><div class="item" data-v-ab6c6bfc><div class="indicator" data-v-ab6c6bfc></div><a class="VPLink link link" href="/api/import-meta.html" data-v-ab6c6bfc><!--[--><p class="text" data-v-ab6c6bfc>import.meta</p><!--]--></a><!----></div><!----></div><div class="VPSidebarItem level-1 is-link" data-v-ab6c6bfc data-v-ab6c6bfc><div class="item" data-v-ab6c6bfc><div class="indicator" data-v-ab6c6bfc></div><a class="VPLink link link" href="/api/sqlite.html" data-v-ab6c6bfc><!--[--><p class="text" data-v-ab6c6bfc>SQLite</p><!--]--></a><!----></div><!----></div><div class="VPSidebarItem level-1 is-link" data-v-ab6c6bfc data-v-ab6c6bfc><div class="item" data-v-ab6c6bfc><div class="indicator" data-v-ab6c6bfc></div><a class="VPLink link link" href="/api/file-system-router.html" data-v-ab6c6bfc><!--[--><p class="text" data-v-ab6c6bfc>FileSystemRouter</p><!--]--></a><!----></div><!----></div><div class="VPSidebarItem level-1 is-link" data-v-ab6c6bfc data-v-ab6c6bfc><div class="item" data-v-ab6c6bfc><div class="indicator" data-v-ab6c6bfc></div><a class="VPLink link link" href="/api/tcp.html" data-v-ab6c6bfc><!--[--><p class="text" data-v-ab6c6bfc>TCP sockets</p><!--]--></a><!----></div><!----></div><div class="VPSidebarItem level-1 is-link" data-v-ab6c6bfc data-v-ab6c6bfc><div class="item" data-v-ab6c6bfc><div class="indicator" data-v-ab6c6bfc></div><a class="VPLink link link" href="/api/globals.html" data-v-ab6c6bfc><!--[--><p class="text" data-v-ab6c6bfc>Globals</p><!--]--></a><!----></div><!----></div><div class="VPSidebarItem level-1 is-link" data-v-ab6c6bfc data-v-ab6c6bfc><div class="item" data-v-ab6c6bfc><div class="indicator" data-v-ab6c6bfc></div><a class="VPLink link link" href="/api/spawn.html" data-v-ab6c6bfc><!--[--><p class="text" data-v-ab6c6bfc>Child processes</p><!--]--></a><!----></div><!----></div><div class="VPSidebarItem level-1 is-link" data-v-ab6c6bfc data-v-ab6c6bfc><div class="item" data-v-ab6c6bfc><div class="indicator" data-v-ab6c6bfc></div><a class="VPLink link link" href="/api/transpiler.html" data-v-ab6c6bfc><!--[--><p class="text" data-v-ab6c6bfc>Transpiler</p><!--]--></a><!----></div><!----></div><div class="VPSidebarItem level-1 is-link" data-v-ab6c6bfc data-v-ab6c6bfc><div class="item" data-v-ab6c6bfc><div class="indicator" data-v-ab6c6bfc></div><a class="VPLink link link" href="/api/hashing.html" data-v-ab6c6bfc><!--[--><p class="text" data-v-ab6c6bfc>Hashing</p><!--]--></a><!----></div><!----></div><div class="VPSidebarItem level-1 is-link" data-v-ab6c6bfc data-v-ab6c6bfc><div class="item" data-v-ab6c6bfc><div class="indicator" data-v-ab6c6bfc></div><a class="VPLink link link" href="/api/console.html" data-v-ab6c6bfc><!--[--><p class="text" data-v-ab6c6bfc>Console</p><!--]--></a><!----></div><!----></div><div class="VPSidebarItem level-1 is-link" data-v-ab6c6bfc data-v-ab6c6bfc><div class="item" data-v-ab6c6bfc><div class="indicator" data-v-ab6c6bfc></div><a class="VPLink link link" href="/api/ffi.html" data-v-ab6c6bfc><!--[--><p class="text" data-v-ab6c6bfc>FFI</p><!--]--></a><!----></div><!----></div><div class="VPSidebarItem level-1 is-link" data-v-ab6c6bfc data-v-ab6c6bfc><div class="item" data-v-ab6c6bfc><div class="indicator" data-v-ab6c6bfc></div><a class="VPLink link link" href="/api/html-rewriter.html" data-v-ab6c6bfc><!--[--><p class="text" data-v-ab6c6bfc>HTMLRewriter</p><!--]--></a><!----></div><!----></div><div class="VPSidebarItem level-1 is-link" data-v-ab6c6bfc data-v-ab6c6bfc><div class="item" data-v-ab6c6bfc><div class="indicator" data-v-ab6c6bfc></div><a class="VPLink link link" href="/api/test.html" data-v-ab6c6bfc><!--[--><p class="text" data-v-ab6c6bfc>Testing</p><!--]--></a><!----></div><!----></div><div class="VPSidebarItem level-1 is-link" data-v-ab6c6bfc data-v-ab6c6bfc><div class="item" data-v-ab6c6bfc><div class="indicator" data-v-ab6c6bfc></div><a class="VPLink link link" href="/api/utils.html" data-v-ab6c6bfc><!--[--><p class="text" data-v-ab6c6bfc>Utils</p><!--]--></a><!----></div><!----></div><div class="VPSidebarItem level-1 is-link" data-v-ab6c6bfc data-v-ab6c6bfc><div class="item" data-v-ab6c6bfc><div class="indicator" data-v-ab6c6bfc></div><a class="VPLink link link" href="/api/node-api.html" data-v-ab6c6bfc><!--[--><p class="text" data-v-ab6c6bfc>Node-API</p><!--]--></a><!----></div><!----></div><!--]--></div></section></div><div class="group" data-v-7d181c84><section class="VPSidebarItem level-0" data-v-7d181c84 data-v-ab6c6bfc><div class="item" role="button" tabindex="0" data-v-ab6c6bfc><div class="indicator" data-v-ab6c6bfc></div><h2 class="text" data-v-ab6c6bfc>Project</h2><!----></div><div class="items" data-v-ab6c6bfc><!--[--><div class="VPSidebarItem level-1 is-link" data-v-ab6c6bfc data-v-ab6c6bfc><div class="item" data-v-ab6c6bfc><div class="indicator" data-v-ab6c6bfc></div><a class="VPLink link link" href="/project/roadmap.html" data-v-ab6c6bfc><!--[--><p class="text" data-v-ab6c6bfc>Roadmap</p><!--]--></a><!----></div><!----></div><div class="VPSidebarItem level-1 is-link" data-v-ab6c6bfc data-v-ab6c6bfc><div class="item" data-v-ab6c6bfc><div class="indicator" data-v-ab6c6bfc></div><a class="VPLink link link" href="/project/benchmarking.html" data-v-ab6c6bfc><!--[--><p class="text" data-v-ab6c6bfc>Benchmarking</p><!--]--></a><!----></div><!----></div><div class="VPSidebarItem level-1 is-link" data-v-ab6c6bfc data-v-ab6c6bfc><div class="item" data-v-ab6c6bfc><div class="indicator" data-v-ab6c6bfc></div><a class="VPLink link link" href="/project/development.html" data-v-ab6c6bfc><!--[--><p class="text" data-v-ab6c6bfc>Development</p><!--]--></a><!----></div><!----></div><div class="VPSidebarItem level-1 is-link" data-v-ab6c6bfc data-v-ab6c6bfc><div class="item" data-v-ab6c6bfc><div class="indicator" data-v-ab6c6bfc></div><a class="VPLink link link" href="/project/licensing.html" data-v-ab6c6bfc><!--[--><p class="text" data-v-ab6c6bfc>License</p><!--]--></a><!----></div><!----></div><!--]--></div></section></div><!--]--><!--[--><!--]--></nav></aside><div class="VPContent has-sidebar" id="VPContent" data-v-95ddf855 data-v-50861403><div class="VPDoc has-sidebar has-aside" data-v-50861403 data-v-72cf3c1c><!--[--><!--]--><div class="container" data-v-72cf3c1c><div class="aside" data-v-72cf3c1c><div class="aside-curtain" data-v-72cf3c1c></div><div class="aside-container" data-v-72cf3c1c><div class="aside-content" data-v-72cf3c1c><div class="VPDocAside" data-v-72cf3c1c data-v-1188e1af><!--[--><!--]--><!--[--><!--]--><div class="VPDocAsideOutline" role="navigation" data-v-1188e1af data-v-963dac4b><div class="content" data-v-963dac4b><div class="outline-marker" data-v-963dac4b></div><div class="outline-title" role="heading" aria-level="2" data-v-963dac4b>On this page</div><nav aria-labelledby="doc-outline-aria-label" data-v-963dac4b><span class="visually-hidden" id="doc-outline-aria-label" data-v-963dac4b> Table of Contents for current page </span><ul class="root" data-v-963dac4b data-v-d76fc147><!--[--><!--]--></ul></nav></div></div><!--[--><!--]--><div class="spacer" data-v-1188e1af></div><!--[--><!--]--><!----><!--[--><!--]--><!--[--><!--]--></div></div></div></div><div class="content" data-v-72cf3c1c><div class="content-container" data-v-72cf3c1c><!--[--><!--]--><!----><main class="main" data-v-72cf3c1c><div style="position:relative;" class="vp-doc _api_utils" data-v-72cf3c1c><div><h1 id="utils" tabindex="-1">Utils <a class="header-anchor" href="#utils" aria-label="Permalink to &quot;Utils&quot;">​</a></h1><h2 id="bun-version" tabindex="-1"><code>Bun.version</code> <a class="header-anchor" href="#bun-version" aria-label="Permalink to &quot;`Bun.version`&quot;">​</a></h2><p>一个包含当前运行的 <code>bun</code> CLI 版本的字符串。</p><div class="language-ts vp-adaptive-theme"><button title="Copy Code" class="copy"></button><span class="lang">ts</span><pre class="shiki github-dark vp-code-dark"><code><span class="line"><span style="color:#E1E4E8;">Bun.version;</span></span>
<span class="line"><span style="color:#6A737D;">// =&gt; &quot;0.6.4&quot;</span></span></code></pre><pre class="shiki github-light vp-code-light"><code><span class="line"><span style="color:#24292E;">Bun.version;</span></span>
<span class="line"><span style="color:#6A737D;">// =&gt; &quot;0.6.4&quot;</span></span></code></pre></div><h2 id="bun-revision" tabindex="-1"><code>Bun.revision</code> <a class="header-anchor" href="#bun-revision" aria-label="Permalink to &quot;`Bun.revision`&quot;">​</a></h2><p><a href="https://github.com/oven-sh/bun" target="_blank" rel="noreferrer">Bun</a> 的 git 提交版本，用于创建当前的 <code>bun</code> CLI。</p><div class="language-ts vp-adaptive-theme"><button title="Copy Code" class="copy"></button><span class="lang">ts</span><pre class="shiki github-dark vp-code-dark"><code><span class="line"><span style="color:#E1E4E8;">Bun.revision;</span></span>
<span class="line"><span style="color:#6A737D;">// =&gt; &quot;f02561530fda1ee9396f51c8bc99b38716e38296&quot;</span></span></code></pre><pre class="shiki github-light vp-code-light"><code><span class="line"><span style="color:#24292E;">Bun.revision;</span></span>
<span class="line"><span style="color:#6A737D;">// =&gt; &quot;f02561530fda1ee9396f51c8bc99b38716e38296&quot;</span></span></code></pre></div><h2 id="bun-env" tabindex="-1"><code>Bun.env</code> <a class="header-anchor" href="#bun-env" aria-label="Permalink to &quot;`Bun.env`&quot;">​</a></h2><p><code>p<wbr>rocess.env</code> 的别名。</p><h2 id="bun-main" tabindex="-1"><code>Bun.main</code> <a class="header-anchor" href="#bun-main" aria-label="Permalink to &quot;`Bun.main`&quot;">​</a></h2><p>当前程序入口的绝对路径（使用 <code>bun run</code> 执行的文件）。</p><div class="language-ts vp-adaptive-theme"><button title="Copy Code" class="copy"></button><span class="lang">ts</span><pre class="shiki github-dark vp-code-dark"><code><span class="line"><span style="color:#E1E4E8;">Bun.main;</span></span>
<span class="line"><span style="color:#6A737D;">// /path/to/script.ts</span></span></code></pre><pre class="shiki github-light vp-code-light"><code><span class="line"><span style="color:#24292E;">Bun.main;</span></span>
<span class="line"><span style="color:#6A737D;">// /path/to/script.ts</span></span></code></pre></div><p>这对于确定脚本是直接执行还是被另一个脚本导入很有用。</p><div class="language-ts vp-adaptive-theme"><button title="Copy Code" class="copy"></button><span class="lang">ts</span><pre class="shiki github-dark vp-code-dark"><code><span class="line"><span style="color:#F97583;">if</span><span style="color:#E1E4E8;"> (</span><span style="color:#F97583;">import</span><span style="color:#E1E4E8;">.</span><span style="color:#79B8FF;">meta</span><span style="color:#E1E4E8;">.path </span><span style="color:#F97583;">===</span><span style="color:#E1E4E8;"> Bun.main) {</span></span>
<span class="line"><span style="color:#E1E4E8;">  </span><span style="color:#6A737D;">// 这个脚本是直接执行的</span></span>
<span class="line"><span style="color:#E1E4E8;">} </span><span style="color:#F97583;">else</span><span style="color:#E1E4E8;"> {</span></span>
<span class="line"><span style="color:#E1E4E8;">  </span><span style="color:#6A737D;">// 这个文件被另一个脚本导入</span></span>
<span class="line"><span style="color:#E1E4E8;">}</span></span></code></pre><pre class="shiki github-light vp-code-light"><code><span class="line"><span style="color:#D73A49;">if</span><span style="color:#24292E;"> (</span><span style="color:#D73A49;">import</span><span style="color:#24292E;">.</span><span style="color:#005CC5;">meta</span><span style="color:#24292E;">.path </span><span style="color:#D73A49;">===</span><span style="color:#24292E;"> Bun.main) {</span></span>
<span class="line"><span style="color:#24292E;">  </span><span style="color:#6A737D;">// 这个脚本是直接执行的</span></span>
<span class="line"><span style="color:#24292E;">} </span><span style="color:#D73A49;">else</span><span style="color:#24292E;"> {</span></span>
<span class="line"><span style="color:#24292E;">  </span><span style="color:#6A737D;">// 这个文件被另一个脚本导入</span></span>
<span class="line"><span style="color:#24292E;">}</span></span></code></pre></div><p>这类似于 Node.js 中的 <a href="https://stackoverflow.com/questions/6398196/detect-if-called-through-require-or-directly-by-command-line" target="_blank" rel="noreferrer"><code>require.main = module</code> 技巧</a>。</p><h2 id="bun-sleep" tabindex="-1"><code>Bun.sleep()</code> <a class="header-anchor" href="#bun-sleep" aria-label="Permalink to &quot;`Bun.sleep()`&quot;">​</a></h2><p><code>Bun.sleep(ms: number)</code></p><p>返回一个在指定毫秒数后解析的 <code>Promise</code>。</p><div class="language-ts vp-adaptive-theme"><button title="Copy Code" class="copy"></button><span class="lang">ts</span><pre class="shiki github-dark vp-code-dark"><code><span class="line"><span style="color:#E1E4E8;">console.</span><span style="color:#B392F0;">log</span><span style="color:#E1E4E8;">(</span><span style="color:#9ECBFF;">&quot;你好&quot;</span><span style="color:#E1E4E8;">);</span></span>
<span class="line"><span style="color:#F97583;">await</span><span style="color:#E1E4E8;"> Bun.</span><span style="color:#B392F0;">sleep</span><span style="color:#E1E4E8;">(</span><span style="color:#79B8FF;">1000</span><span style="color:#E1E4E8;">);</span></span>
<span class="line"><span style="color:#E1E4E8;">console.</span><span style="color:#B392F0;">log</span><span style="color:#E1E4E8;">(</span><span style="color:#9ECBFF;">&quot;一秒后你好！&quot;</span><span style="color:#E1E4E8;">);</span></span></code></pre><pre class="shiki github-light vp-code-light"><code><span class="line"><span style="color:#24292E;">console.</span><span style="color:#6F42C1;">log</span><span style="color:#24292E;">(</span><span style="color:#032F62;">&quot;你好&quot;</span><span style="color:#24292E;">);</span></span>
<span class="line"><span style="color:#D73A49;">await</span><span style="color:#24292E;"> Bun.</span><span style="color:#6F42C1;">sleep</span><span style="color:#24292E;">(</span><span style="color:#005CC5;">1000</span><span style="color:#24292E;">);</span></span>
<span class="line"><span style="color:#24292E;">console.</span><span style="color:#6F42C1;">log</span><span style="color:#24292E;">(</span><span style="color:#032F62;">&quot;一秒后你好！&quot;</span><span style="color:#24292E;">);</span></span></code></pre></div><p>或者，传递一个 <code>Date</code> 对象以接收在那个时间点解析的 <code>Promise</code>。</p><div class="language-ts vp-adaptive-theme"><button title="Copy Code" class="copy"></button><span class="lang">ts</span><pre class="shiki github-dark vp-code-dark"><code><span class="line"><span style="color:#F97583;">const</span><span style="color:#E1E4E8;"> </span><span style="color:#79B8FF;">未来的一秒</span><span style="color:#E1E4E8;"> </span><span style="color:#F97583;">=</span><span style="color:#E1E4E8;"> </span><span style="color:#F97583;">new</span><span style="color:#E1E4E8;"> </span><span style="color:#B392F0;">Date</span><span style="color:#E1E4E8;">(Date.</span><span style="color:#B392F0;">now</span><span style="color:#E1E4E8;">() </span><span style="color:#F97583;">+</span><span style="color:#E1E4E8;"> </span><span style="color:#79B8FF;">1000</span><span style="color:#E1E4E8;">);</span></span>
<span class="line"></span>
<span class="line"><span style="color:#E1E4E8;">console.</span><span style="color:#B392F0;">log</span><span style="color:#E1E4E8;">(</span><span style="color:#9ECBFF;">&quot;你好&quot;</span><span style="color:#E1E4E8;">);</span></span>
<span class="line"><span style="color:#F97583;">await</span><span style="color:#E1E4E8;"> Bun.</span><span style="color:#B392F0;">sleep</span><span style="color:#E1E4E8;">(未来的一秒);</span></span>
<span class="line"><span style="color:#E1E4E8;">console.</span><span style="color:#B392F0;">log</span><span style="color:#E1E4E8;">(</span><span style="color:#9ECBFF;">&quot;一秒后你好！&quot;</span><span style="color:#E1E4E8;">);</span></span></code></pre><pre class="shiki github-light vp-code-light"><code><span class="line"><span style="color:#D73A49;">const</span><span style="color:#24292E;"> </span><span style="color:#005CC5;">未来的一秒</span><span style="color:#24292E;"> </span><span style="color:#D73A49;">=</span><span style="color:#24292E;"> </span><span style="color:#D73A49;">new</span><span style="color:#24292E;"> </span><span style="color:#6F42C1;">Date</span><span style="color:#24292E;">(Date.</span><span style="color:#6F42C1;">now</span><span style="color:#24292E;">() </span><span style="color:#D73A49;">+</span><span style="color:#24292E;"> </span><span style="color:#005CC5;">1000</span><span style="color:#24292E;">);</span></span>
<span class="line"></span>
<span class="line"><span style="color:#24292E;">console.</span><span style="color:#6F42C1;">log</span><span style="color:#24292E;">(</span><span style="color:#032F62;">&quot;你好&quot;</span><span style="color:#24292E;">);</span></span>
<span class="line"><span style="color:#D73A49;">await</span><span style="color:#24292E;"> Bun.</span><span style="color:#6F42C1;">sleep</span><span style="color:#24292E;">(未来的一秒);</span></span>
<span class="line"><span style="color:#24292E;">console.</span><span style="color:#6F42C1;">log</span><span style="color:#24292E;">(</span><span style="color:#032F62;">&quot;一秒后你好！&quot;</span><span style="color:#24292E;">);</span></span></code></pre></div><h2 id="bun-sleepsync" tabindex="-1"><code>Bun.sleepSync()</code> <a class="header-anchor" href="#bun-sleepsync" aria-label="Permalink to &quot;`Bun.sleepSync()`&quot;">​</a></h2><p><code>Bun.sleepSync(ms: number)</code></p><p><code>Bun.sleep</code> 的阻塞同步版本。</p><div class="language-ts vp-adaptive-theme"><button title="Copy Code" class="copy"></button><span class="lang">ts</span><pre class="shiki github-dark vp-code-dark"><code><span class="line"><span style="color:#E1E4E8;">console.</span><span style="color:#B392F0;">log</span><span style="color:#E1E4E8;">(</span><span style="color:#9ECBFF;">&quot;你好&quot;</span><span style="color:#E1E4E8;">);</span></span>
<span class="line"><span style="color:#E1E4E8;">Bun.</span><span style="color:#B392F0;">sleepSync</span><span style="color:#E1E4E8;">(</span><span style="color:#79B8FF;">1000</span><span style="color:#E1E4E8;">); </span><span style="color:#6A737D;">// 阻塞线程一秒钟</span></span>
<span class="line"><span style="color:#E1E4E8;">console.</span><span style="color:#B392F0;">log</span><span style="color:#E1E4E8;">(</span><span style="color:#9ECBFF;">&quot;一秒后你好！&quot;</span><span style="color:#E1E4E8;">);</span></span></code></pre><pre class="shiki github-light vp-code-light"><code><span class="line"><span style="color:#24292E;">console.</span><span style="color:#6F42C1;">log</span><span style="color:#24292E;">(</span><span style="color:#032F62;">&quot;你好&quot;</span><span style="color:#24292E;">);</span></span>
<span class="line"><span style="color:#24292E;">Bun.</span><span style="color:#6F42C1;">sleepSync</span><span style="color:#24292E;">(</span><span style="color:#005CC5;">1000</span><span style="color:#24292E;">); </span><span style="color:#6A737D;">// 阻塞线程一秒钟</span></span>
<span class="line"><span style="color:#24292E;">console.</span><span style="color:#6F42C1;">log</span><span style="color:#24292E;">(</span><span style="color:#032F62;">&quot;一秒后你好！&quot;</span><span style="color:#24292E;">);</span></span></code></pre></div><h2 id="bun-which" tabindex="-1"><code>Bun.which()</code> <a class="header-anchor" href="#bun-which" aria-label="Permalink to &quot;`Bun.which()`&quot;">​</a></h2><p><code>Bun.which(bin: string)</code></p><p>返回可执行文件的路径，类似于在终端中输入 <code>which</code>。</p><div class="language-ts vp-adaptive-theme"><button title="Copy Code" class="copy"></button><span class="lang">ts</span><pre class="shiki github-dark vp-code-dark"><code><span class="line"><span style="color:#F97583;">const</span><span style="color:#E1E4E8;"> </span><span style="color:#79B8FF;">ls</span><span style="color:#E1E4E8;"> </span><span style="color:#F97583;">=</span><span style="color:#E1E4E8;"> Bun.</span><span style="color:#B392F0;">which</span><span style="color:#E1E4E8;">(</span><span style="color:#9ECBFF;">&quot;ls&quot;</span><span style="color:#E1E4E8;">);</span></span>
<span class="line"><span style="color:#E1E4E8;">console.</span><span style="color:#B392F0;">log</span><span style="color:#E1E4E8;">(ls); </span><span style="color:#6A737D;">// &quot;/usr/bin/ls&quot;</span></span></code></pre><pre class="shiki github-light vp-code-light"><code><span class="line"><span style="color:#D73A49;">const</span><span style="color:#24292E;"> </span><span style="color:#005CC5;">ls</span><span style="color:#24292E;"> </span><span style="color:#D73A49;">=</span><span style="color:#24292E;"> Bun.</span><span style="color:#6F42C1;">which</span><span style="color:#24292E;">(</span><span style="color:#032F62;">&quot;ls&quot;</span><span style="color:#24292E;">);</span></span>
<span class="line"><span style="color:#24292E;">console.</span><span style="color:#6F42C1;">log</span><span style="color:#24292E;">(ls); </span><span style="color:#6A737D;">// &quot;/usr/bin/ls&quot;</span></span></code></pre></div><p>默认情况下，Bun 查看当前的 <code>PATH</code> 环境变量来确定路径。要配置 <code>PATH</code>：</p><div class="language-ts vp-adaptive-theme"><button title="Copy Code" class="copy"></button><span class="lang">ts</span><pre class="shiki github-dark vp-code-dark"><code><span class="line"><span style="color:#F97583;">const</span><span style="color:#E1E4E8;"> </span><span style="color:#79B8FF;">ls</span><span style="color:#E1E4E8;"> </span><span style="color:#F97583;">=</span><span style="color:#E1E4E8;"> Bun.</span><span style="color:#B392F0;">which</span><span style="color:#E1E4E8;">(</span><span style="color:#9ECBFF;">&quot;ls&quot;</span><span style="color:#E1E4E8;">, {</span></span>
<span class="line"><span style="color:#E1E4E8;">  PATH: </span><span style="color:#9ECBFF;">&quot;/usr/local/bin:/usr/bin:/bin&quot;</span><span style="color:#E1E4E8;">,</span></span>
<span class="line"><span style="color:#E1E4E8;">});</span></span>
<span class="line"><span style="color:#E1E4E8;">console.</span><span style="color:#B392F0;">log</span><span style="color:#E1E4E8;">(ls); </span><span style="color:#6A737D;">// &quot;/usr/bin/ls&quot;</span></span></code></pre><pre class="shiki github-light vp-code-light"><code><span class="line"><span style="color:#D73A49;">const</span><span style="color:#24292E;"> </span><span style="color:#005CC5;">ls</span><span style="color:#24292E;"> </span><span style="color:#D73A49;">=</span><span style="color:#24292E;"> Bun.</span><span style="color:#6F42C1;">which</span><span style="color:#24292E;">(</span><span style="color:#032F62;">&quot;ls&quot;</span><span style="color:#24292E;">, {</span></span>
<span class="line"><span style="color:#24292E;">  PATH: </span><span style="color:#032F62;">&quot;/usr/local/bin:/usr/bin:/bin&quot;</span><span style="color:#24292E;">,</span></span>
<span class="line"><span style="color:#24292E;">});</span></span>
<span class="line"><span style="color:#24292E;">console.</span><span style="color:#6F42C1;">log</span><span style="color:#24292E;">(ls); </span><span style="color:#6A737D;">// &quot;/usr/bin/ls&quot;</span></span></code></pre></div><p>通过传递一个 <code>cwd</code> 选项来从特定目录解析可执行文件。</p><div class="language-ts vp-adaptive-theme"><button title="Copy Code" class="copy"></button><span class="lang">ts</span><pre class="shiki github-dark vp-code-dark"><code><span class="line"><span style="color:#F97583;">const</span><span style="color:#E1E4E8;"> </span><span style="color:#79B8FF;">ls</span><span style="color:#E1E4E8;"> </span><span style="color:#F97583;">=</span><span style="color:#E1E4E8;"> Bun.</span><span style="color:#B392F0;">which</span><span style="color:#E1E4E8;">(</span><span style="color:#9ECBFF;">&quot;ls&quot;</span><span style="color:#E1E4E8;">, {</span></span>
<span class="line"><span style="color:#E1E4E8;">  cwd: </span><span style="color:#9ECBFF;">&quot;/tmp&quot;</span><span style="color:#E1E4E8;">,</span></span>
<span class="line"><span style="color:#E1E4E8;">  PATH: </span><span style="color:#9ECBFF;">&quot;&quot;</span><span style="color:#E1E4E8;">,</span></span>
<span class="line"><span style="color:#E1E4E8;">});</span></span>
<span class="line"></span>
<span class="line"><span style="color:#E1E4E8;">console.</span><span style="color:#B392F0;">log</span><span style="color:#E1E4E8;">(ls); </span><span style="color:#6A737D;">// null</span></span></code></pre><pre class="shiki github-light vp-code-light"><code><span class="line"><span style="color:#D73A49;">const</span><span style="color:#24292E;"> </span><span style="color:#005CC5;">ls</span><span style="color:#24292E;"> </span><span style="color:#D73A49;">=</span><span style="color:#24292E;"> Bun.</span><span style="color:#6F42C1;">which</span><span style="color:#24292E;">(</span><span style="color:#032F62;">&quot;ls&quot;</span><span style="color:#24292E;">, {</span></span>
<span class="line"><span style="color:#24292E;">  cwd: </span><span style="color:#032F62;">&quot;/tmp&quot;</span><span style="color:#24292E;">,</span></span>
<span class="line"><span style="color:#24292E;">  PATH: </span><span style="color:#032F62;">&quot;&quot;</span><span style="color:#24292E;">,</span></span>
<span class="line"><span style="color:#24292E;">});</span></span>
<span class="line"></span>
<span class="line"><span style="color:#24292E;">console.</span><span style="color:#6F42C1;">log</span><span style="color:#24292E;">(ls); </span><span style="color:#6A737D;">// null</span></span></code></pre></div><h2 id="bun-peek" tabindex="-1"><code>Bun.peek()</code> <a class="header-anchor" href="#bun-peek" aria-label="Permalink to &quot;`Bun.peek()`&quot;">​</a></h2><p><code>Bun.peek(prom: Promise)</code></p><p>在 <code>await</code> 或 <code>.then</code> 之前读取 Promise 的结果，但仅当 Promise 已经完成或拒绝时。</p><div class="language-ts vp-adaptive-theme"><button title="Copy Code" class="copy"></button><span class="lang">ts</span><pre class="shiki github-dark vp-code-dark"><code><span class="line"><span style="color:#F97583;">import</span><span style="color:#E1E4E8;"> { peek } </span><span style="color:#F97583;">from</span><span style="color:#E1E4E8;"> </span><span style="color:#9ECBFF;">&quot;bun&quot;</span><span style="color:#E1E4E8;">;</span></span>
<span class="line"></span>
<span class="line"><span style="color:#F97583;">const</span><span style="color:#E1E4E8;"> </span><span style="color:#79B8FF;">promise</span><span style="color:#E1E4E8;"> </span><span style="color:#F97583;">=</span><span style="color:#E1E4E8;"> </span><span style="color:#79B8FF;">Promise</span><span style="color:#E1E4E8;">.</span><span style="color:#B392F0;">resolve</span><span style="color:#E1E4E8;">(</span><span style="color:#9ECBFF;">&quot;你好&quot;</span><span style="color:#E1E4E8;">);</span></span>
<span class="line"></span>
<span class="line"><span style="color:#6A737D;">// 无需 await！</span></span>
<span class="line"><span style="color:#F97583;">const</span><span style="color:#E1E4E8;"> </span><span style="color:#79B8FF;">result</span><span style="color:#E1E4E8;"> </span><span style="color:#F97583;">=</span><span style="color:#E1E4E8;"> </span><span style="color:#B392F0;">peek</span><span style="color:#E1E4E8;">(promise);</span></span>
<span class="line"><span style="color:#E1E4E8;">console.</span><span style="color:#B392F0;">log</span><span style="color:#E1E4E8;">(result); </span><span style="color:#6A737D;">// &quot;你好&quot;</span></span></code></pre><pre class="shiki github-light vp-code-light"><code><span class="line"><span style="color:#D73A49;">import</span><span style="color:#24292E;"> { peek } </span><span style="color:#D73A49;">from</span><span style="color:#24292E;"> </span><span style="color:#032F62;">&quot;bun&quot;</span><span style="color:#24292E;">;</span></span>
<span class="line"></span>
<span class="line"><span style="color:#D73A49;">const</span><span style="color:#24292E;"> </span><span style="color:#005CC5;">promise</span><span style="color:#24292E;"> </span><span style="color:#D73A49;">=</span><span style="color:#24292E;"> </span><span style="color:#005CC5;">Promise</span><span style="color:#24292E;">.</span><span style="color:#6F42C1;">resolve</span><span style="color:#24292E;">(</span><span style="color:#032F62;">&quot;你好&quot;</span><span style="color:#24292E;">);</span></span>
<span class="line"></span>
<span class="line"><span style="color:#6A737D;">// 无需 await！</span></span>
<span class="line"><span style="color:#D73A49;">const</span><span style="color:#24292E;"> </span><span style="color:#005CC5;">result</span><span style="color:#24292E;"> </span><span style="color:#D73A49;">=</span><span style="color:#24292E;"> </span><span style="color:#6F42C1;">peek</span><span style="color:#24292E;">(promise);</span></span>
<span class="line"><span style="color:#24292E;">console.</span><span style="color:#6F42C1;">log</span><span style="color:#24292E;">(result); </span><span style="color:#6A737D;">// &quot;你好&quot;</span></span></code></pre></div><p>这在尝试减少性能敏感代码中不必要的微任务数时很重要。这是一个高级 API，除非你知道自己在做什么，否则最好不要使用它。</p><div class="language-ts vp-adaptive-theme"><button title="Copy Code" class="copy"></button><span class="lang">ts</span><pre class="shiki github-dark vp-code-dark"><code><span class="line"><span style="color:#F97583;">import</span><span style="color:#E1E4E8;"> { peek } </span><span style="color:#F97583;">from</span><span style="color:#E1E4E8;"> </span><span style="color:#9ECBFF;">&quot;bun&quot;</span><span style="color:#E1E4E8;">;</span></span>
<span class="line"><span style="color:#F97583;">import</span><span style="color:#E1E4E8;"> { expect, test } </span><span style="color:#F97583;">from</span><span style="color:#E1E4E8;"> </span><span style="color:#9ECBFF;">&quot;bun:test&quot;</span><span style="color:#E1E4E8;">;</span></span>
<span class="line"></span>
<span class="line"><span style="color:#B392F0;">test</span><span style="color:#E1E4E8;">(</span><span style="color:#9ECBFF;">&quot;peek&quot;</span><span style="color:#E1E4E8;">, () </span><span style="color:#F97583;">=&gt;</span><span style="color:#E1E4E8;"> {</span></span>
<span class="line"><span style="color:#E1E4E8;">  </span><span style="color:#F97583;">const</span><span style="color:#E1E4E8;"> </span><span style="color:#79B8FF;">promise</span><span style="color:#E1E4E8;"> </span><span style="color:#F97583;">=</span><span style="color:#E1E4E8;"> </span><span style="color:#79B8FF;">Promise</span><span style="color:#E1E4E8;">.</span><span style="color:#B392F0;">resolve</span><span style="color:#E1E4E8;">(</span><span style="color:#79B8FF;">true</span><span style="color:#E1E4E8;">);</span></span>
<span class="line"></span>
<span class="line"><span style="color:#E1E4E8;">  </span><span style="color:#6A737D;">// 不需要 await！</span></span>
<span class="line"><span style="color:#E1E4E8;">  </span><span style="color:#B392F0;">expect</span><span style="color:#E1E4E8;">(</span><span style="color:#B392F0;">peek</span><span style="color:#E1E4E8;">(promise)).</span><span style="color:#B392F0;">toBe</span><span style="color:#E1E4E8;">(</span><span style="color:#79B8FF;">true</span><span style="color:#E1E4E8;">);</span></span>
<span class="line"></span>
<span class="line"><span style="color:#E1E4E8;">  </span><span style="color:#6A737D;">// 如果我们再次 peek，它将返回相同的值</span></span>
<span class="line"><span style="color:#E1E4E8;">  </span><span style="color:#F97583;">const</span><span style="color:#E1E4E8;"> </span><span style="color:#79B8FF;">again</span><span style="color:#E1E4E8;"> </span><span style="color:#F97583;">=</span><span style="color:#E1E4E8;"> </span><span style="color:#B392F0;">peek</span><span style="color:#E1E4E8;">(promise);</span></span>
<span class="line"><span style="color:#E1E4E8;">  </span><span style="color:#B392F0;">expect</span><span style="color:#E1E4E8;">(again).</span><span style="color:#B392F0;">toBe</span><span style="color:#E1E4E8;">(</span><span style="color:#79B8FF;">true</span><span style="color:#E1E4E8;">);</span></span>
<span class="line"></span>
<span class="line"><span style="color:#E1E4E8;">  </span><span style="color:#6A737D;">// 如果我们 peek 一个非 Promise，它将返回该值</span></span>
<span class="line"><span style="color:#E1E4E8;">  </span><span style="color:#F97583;">const</span><span style="color:#E1E4E8;"> </span><span style="color:#79B8FF;">value</span><span style="color:#E1E4E8;"> </span><span style="color:#F97583;">=</span><span style="color:#E1E4E8;"> </span><span style="color:#B392F0;">peek</span><span style="color:#E1E4E8;">(</span><span style="color:#79B8FF;">42</span><span style="color:#E1E4E8;">);</span></span>
<span class="line"><span style="color:#E1E4E8;">  </span><span style="color:#B392F0;">expect</span><span style="color:#E1E4E8;">(value).</span><span style="color:#B392F0;">toBe</span><span style="color:#E1E4E8;">(</span><span style="color:#79B8FF;">42</span><span style="color:#E1E4E8;">);</span></span>
<span class="line"></span>
<span class="line"><span style="color:#E1E4E8;">  </span><span style="color:#6A737D;">// 如果我们 peek 一个挂起的 Promise，它将再次返回 Promise</span></span>
<span class="line"><span style="color:#E1E4E8;">  </span><span style="color:#F97583;">const</span><span style="color:#E1E4E8;"> </span><span style="color:#79B8FF;">pending</span><span style="color:#E1E4E8;"> </span><span style="color:#F97583;">=</span><span style="color:#E1E4E8;"> </span><span style="color:#F97583;">new</span><span style="color:#E1E4E8;"> </span><span style="color:#79B8FF;">Promise</span><span style="color:#E1E4E8;">(() </span><span style="color:#F97583;">=&gt;</span><span style="color:#E1E4E8;"> {});</span></span>
<span class="line"><span style="color:#E1E4E8;">  </span><span style="color:#B392F0;">expect</span><span style="color:#E1E4E8;">(</span><span style="color:#B392F0;">peek</span><span style="color:#E1E4E8;">(pending)).</span><span style="color:#B392F0;">toBe</span><span style="color:#E1E4E8;">(pending);</span></span>
<span class="line"></span>
<span class="line"><span style="color:#E1E4E8;">  </span><span style="color:#6A737D;">// 如果我们 peek 一个拒绝的 Promise，它将：</span></span>
<span class="line"><span style="color:#E1E4E8;">  </span><span style="color:#6A737D;">// - 返回错误</span></span>
<span class="line"><span style="color:#E1E4E8;">  </span><span style="color:#6A737D;">// - 不标记 Promise 为已处理</span></span>
<span class="line"><span style="color:#E1E4E8;">  </span><span style="color:#F97583;">const</span><span style="color:#E1E4E8;"> </span><span style="color:#79B8FF;">rejected</span><span style="color:#E1E4E8;"> </span><span style="color:#F97583;">=</span><span style="color:#E1E4E8;"> </span><span style="color:#79B8FF;">Promise</span><span style="color:#E1E4E8;">.</span><span style="color:#B392F0;">reject</span><span style="color:#E1E4E8;">(</span><span style="color:#F97583;">new</span><span style="color:#E1E4E8;"> </span><span style="color:#B392F0;">Error</span><span style="color:#E1E4E8;">(</span><span style="color:#9ECBFF;">&quot;成功测试 Promise 拒绝&quot;</span><span style="color:#E1E4E8;">));</span></span>
<span class="line"><span style="color:#E1E4E8;">  </span><span style="color:#B392F0;">expect</span><span style="color:#E1E4E8;">(</span><span style="color:#B392F0;">peek</span><span style="color:#E1E4E8;">(rejected).message).</span><span style="color:#B392F0;">toBe</span><span style="color:#E1E4E8;">(</span><span style="color:#9ECBFF;">&quot;成功测试 Promise 拒绝&quot;</span><span style="color:#E1E4E8;">);</span></span>
<span class="line"><span style="color:#E1E4E8;">});</span></span></code></pre><pre class="shiki github-light vp-code-light"><code><span class="line"><span style="color:#D73A49;">import</span><span style="color:#24292E;"> { peek } </span><span style="color:#D73A49;">from</span><span style="color:#24292E;"> </span><span style="color:#032F62;">&quot;bun&quot;</span><span style="color:#24292E;">;</span></span>
<span class="line"><span style="color:#D73A49;">import</span><span style="color:#24292E;"> { expect, test } </span><span style="color:#D73A49;">from</span><span style="color:#24292E;"> </span><span style="color:#032F62;">&quot;bun:test&quot;</span><span style="color:#24292E;">;</span></span>
<span class="line"></span>
<span class="line"><span style="color:#6F42C1;">test</span><span style="color:#24292E;">(</span><span style="color:#032F62;">&quot;peek&quot;</span><span style="color:#24292E;">, () </span><span style="color:#D73A49;">=&gt;</span><span style="color:#24292E;"> {</span></span>
<span class="line"><span style="color:#24292E;">  </span><span style="color:#D73A49;">const</span><span style="color:#24292E;"> </span><span style="color:#005CC5;">promise</span><span style="color:#24292E;"> </span><span style="color:#D73A49;">=</span><span style="color:#24292E;"> </span><span style="color:#005CC5;">Promise</span><span style="color:#24292E;">.</span><span style="color:#6F42C1;">resolve</span><span style="color:#24292E;">(</span><span style="color:#005CC5;">true</span><span style="color:#24292E;">);</span></span>
<span class="line"></span>
<span class="line"><span style="color:#24292E;">  </span><span style="color:#6A737D;">// 不需要 await！</span></span>
<span class="line"><span style="color:#24292E;">  </span><span style="color:#6F42C1;">expect</span><span style="color:#24292E;">(</span><span style="color:#6F42C1;">peek</span><span style="color:#24292E;">(promise)).</span><span style="color:#6F42C1;">toBe</span><span style="color:#24292E;">(</span><span style="color:#005CC5;">true</span><span style="color:#24292E;">);</span></span>
<span class="line"></span>
<span class="line"><span style="color:#24292E;">  </span><span style="color:#6A737D;">// 如果我们再次 peek，它将返回相同的值</span></span>
<span class="line"><span style="color:#24292E;">  </span><span style="color:#D73A49;">const</span><span style="color:#24292E;"> </span><span style="color:#005CC5;">again</span><span style="color:#24292E;"> </span><span style="color:#D73A49;">=</span><span style="color:#24292E;"> </span><span style="color:#6F42C1;">peek</span><span style="color:#24292E;">(promise);</span></span>
<span class="line"><span style="color:#24292E;">  </span><span style="color:#6F42C1;">expect</span><span style="color:#24292E;">(again).</span><span style="color:#6F42C1;">toBe</span><span style="color:#24292E;">(</span><span style="color:#005CC5;">true</span><span style="color:#24292E;">);</span></span>
<span class="line"></span>
<span class="line"><span style="color:#24292E;">  </span><span style="color:#6A737D;">// 如果我们 peek 一个非 Promise，它将返回该值</span></span>
<span class="line"><span style="color:#24292E;">  </span><span style="color:#D73A49;">const</span><span style="color:#24292E;"> </span><span style="color:#005CC5;">value</span><span style="color:#24292E;"> </span><span style="color:#D73A49;">=</span><span style="color:#24292E;"> </span><span style="color:#6F42C1;">peek</span><span style="color:#24292E;">(</span><span style="color:#005CC5;">42</span><span style="color:#24292E;">);</span></span>
<span class="line"><span style="color:#24292E;">  </span><span style="color:#6F42C1;">expect</span><span style="color:#24292E;">(value).</span><span style="color:#6F42C1;">toBe</span><span style="color:#24292E;">(</span><span style="color:#005CC5;">42</span><span style="color:#24292E;">);</span></span>
<span class="line"></span>
<span class="line"><span style="color:#24292E;">  </span><span style="color:#6A737D;">// 如果我们 peek 一个挂起的 Promise，它将再次返回 Promise</span></span>
<span class="line"><span style="color:#24292E;">  </span><span style="color:#D73A49;">const</span><span style="color:#24292E;"> </span><span style="color:#005CC5;">pending</span><span style="color:#24292E;"> </span><span style="color:#D73A49;">=</span><span style="color:#24292E;"> </span><span style="color:#D73A49;">new</span><span style="color:#24292E;"> </span><span style="color:#005CC5;">Promise</span><span style="color:#24292E;">(() </span><span style="color:#D73A49;">=&gt;</span><span style="color:#24292E;"> {});</span></span>
<span class="line"><span style="color:#24292E;">  </span><span style="color:#6F42C1;">expect</span><span style="color:#24292E;">(</span><span style="color:#6F42C1;">peek</span><span style="color:#24292E;">(pending)).</span><span style="color:#6F42C1;">toBe</span><span style="color:#24292E;">(pending);</span></span>
<span class="line"></span>
<span class="line"><span style="color:#24292E;">  </span><span style="color:#6A737D;">// 如果我们 peek 一个拒绝的 Promise，它将：</span></span>
<span class="line"><span style="color:#24292E;">  </span><span style="color:#6A737D;">// - 返回错误</span></span>
<span class="line"><span style="color:#24292E;">  </span><span style="color:#6A737D;">// - 不标记 Promise 为已处理</span></span>
<span class="line"><span style="color:#24292E;">  </span><span style="color:#D73A49;">const</span><span style="color:#24292E;"> </span><span style="color:#005CC5;">rejected</span><span style="color:#24292E;"> </span><span style="color:#D73A49;">=</span><span style="color:#24292E;"> </span><span style="color:#005CC5;">Promise</span><span style="color:#24292E;">.</span><span style="color:#6F42C1;">reject</span><span style="color:#24292E;">(</span><span style="color:#D73A49;">new</span><span style="color:#24292E;"> </span><span style="color:#6F42C1;">Error</span><span style="color:#24292E;">(</span><span style="color:#032F62;">&quot;成功测试 Promise 拒绝&quot;</span><span style="color:#24292E;">));</span></span>
<span class="line"><span style="color:#24292E;">  </span><span style="color:#6F42C1;">expect</span><span style="color:#24292E;">(</span><span style="color:#6F42C1;">peek</span><span style="color:#24292E;">(rejected).message).</span><span style="color:#6F42C1;">toBe</span><span style="color:#24292E;">(</span><span style="color:#032F62;">&quot;成功测试 Promise 拒绝&quot;</span><span style="color:#24292E;">);</span></span>
<span class="line"><span style="color:#24292E;">});</span></span></code></pre></div><p><code>peek.status</code> 函数允许你读取 Promise 的状态而不解析它。</p><div class="language-ts vp-adaptive-theme"><button title="Copy Code" class="copy"></button><span class="lang">ts</span><pre class="shiki github-dark vp-code-dark"><code><span class="line"><span style="color:#F97583;">import</span><span style="color:#E1E4E8;"> { peek } </span><span style="color:#F97583;">from</span><span style="color:#E1E4E8;"> </span><span style="color:#9ECBFF;">&quot;bun&quot;</span><span style="color:#E1E4E8;">;</span></span>
<span class="line"><span style="color:#F97583;">import</span><span style="color:#E1E4E8;"> { expect, test } </span><span style="color:#F97583;">from</span><span style="color:#E1E4E8;"> </span><span style="color:#9ECBFF;">&quot;bun:test&quot;</span><span style="color:#E1E4E8;">;</span></span>
<span class="line"></span>
<span class="line"><span style="color:#B392F0;">test</span><span style="color:#E1E4E8;">(</span><span style="color:#9ECBFF;">&quot;peek.status&quot;</span><span style="color:#E1E4E8;">, () </span><span style="color:#F97583;">=&gt;</span><span style="color:#E1E4E8;"> {</span></span>
<span class="line"><span style="color:#E1E4E8;">  </span><span style="color:#F97583;">const</span><span style="color:#E1E4E8;"> </span><span style="color:#79B8FF;">promise</span><span style="color:#E1E4E8;"> </span><span style="color:#F97583;">=</span><span style="color:#E1E4E8;"> </span><span style="color:#79B8FF;">Promise</span><span style="color:#E1E4E8;">.</span><span style="color:#B392F0;">resolve</span><span style="color:#E1E4E8;">(</span><span style="color:#79B8FF;">true</span><span style="color:#E1E4E8;">);</span></span>
<span class="line"><span style="color:#E1E4E8;">  </span><span style="color:#B392F0;">expect</span><span style="color:#E1E4E8;">(peek.</span><span style="color:#B392F0;">status</span><span style="color:#E1E4E8;">(promise)).</span><span style="color:#B392F0;">toBe</span><span style="color:#E1E4E8;">(</span><span style="color:#9ECBFF;">&quot;fulfilled&quot;</span><span style="color:#E1E4E8;">);</span></span>
<span class="line"></span>
<span class="line"><span style="color:#E1E4E8;">  </span><span style="color:#F97583;">const</span><span style="color:#E1E4E8;"> </span><span style="color:#79B8FF;">pending</span><span style="color:#E1E4E8;"> </span><span style="color:#F97583;">=</span><span style="color:#E1E4E8;"> </span><span style="color:#F97583;">new</span><span style="color:#E1E4E8;"> </span><span style="color:#79B8FF;">Promise</span><span style="color:#E1E4E8;">(() </span><span style="color:#F97583;">=&gt;</span><span style="color:#E1E4E8;"> {});</span></span>
<span class="line"><span style="color:#E1E4E8;">  </span><span style="color:#B392F0;">expect</span><span style="color:#E1E4E8;">(peek.</span><span style="color:#B392F0;">status</span><span style="color:#E1E4E8;">(pending)).</span><span style="color:#B392F0;">toBe</span><span style="color:#E1E4E8;">(</span><span style="color:#9ECBFF;">&quot;pending&quot;</span><span style="color:#E1E4E8;">);</span></span>
<span class="line"></span>
<span class="line"><span style="color:#E1E4E8;">  </span><span style="color:#F97583;">const</span><span style="color:#E1E4E8;"> </span><span style="color:#79B8FF;">rejected</span><span style="color:#E1E4E8;"> </span><span style="color:#F97583;">=</span><span style="color:#E1E4E8;"> </span><span style="color:#79B8FF;">Promise</span><span style="color:#E1E4E8;">.</span><span style="color:#B392F0;">reject</span><span style="color:#E1E4E8;">(</span><span style="color:#F97583;">new</span><span style="color:#E1E4E8;"> </span><span style="color:#B392F0;">Error</span><span style="color:#E1E4E8;">(</span><span style="color:#9ECBFF;">&quot;哦不&quot;</span><span style="color:#E1E4E8;">));</span></span>
<span class="line"><span style="color:#E1E4E8;">  </span><span style="color:#B392F0;">expect</span><span style="color:#E1E4E8;">(peek.</span><span style="color:#B392F0;">status</span><span style="color:#E1E4E8;">(rejected)).</span><span style="color:#B392F0;">toBe</span><span style="color:#E1E4E8;">(</span><span style="color:#9ECBFF;">&quot;rejected&quot;</span><span style="color:#E1E4E8;">);</span></span>
<span class="line"><span style="color:#E1E4E8;">});</span></span></code></pre><pre class="shiki github-light vp-code-light"><code><span class="line"><span style="color:#D73A49;">import</span><span style="color:#24292E;"> { peek } </span><span style="color:#D73A49;">from</span><span style="color:#24292E;"> </span><span style="color:#032F62;">&quot;bun&quot;</span><span style="color:#24292E;">;</span></span>
<span class="line"><span style="color:#D73A49;">import</span><span style="color:#24292E;"> { expect, test } </span><span style="color:#D73A49;">from</span><span style="color:#24292E;"> </span><span style="color:#032F62;">&quot;bun:test&quot;</span><span style="color:#24292E;">;</span></span>
<span class="line"></span>
<span class="line"><span style="color:#6F42C1;">test</span><span style="color:#24292E;">(</span><span style="color:#032F62;">&quot;peek.status&quot;</span><span style="color:#24292E;">, () </span><span style="color:#D73A49;">=&gt;</span><span style="color:#24292E;"> {</span></span>
<span class="line"><span style="color:#24292E;">  </span><span style="color:#D73A49;">const</span><span style="color:#24292E;"> </span><span style="color:#005CC5;">promise</span><span style="color:#24292E;"> </span><span style="color:#D73A49;">=</span><span style="color:#24292E;"> </span><span style="color:#005CC5;">Promise</span><span style="color:#24292E;">.</span><span style="color:#6F42C1;">resolve</span><span style="color:#24292E;">(</span><span style="color:#005CC5;">true</span><span style="color:#24292E;">);</span></span>
<span class="line"><span style="color:#24292E;">  </span><span style="color:#6F42C1;">expect</span><span style="color:#24292E;">(peek.</span><span style="color:#6F42C1;">status</span><span style="color:#24292E;">(promise)).</span><span style="color:#6F42C1;">toBe</span><span style="color:#24292E;">(</span><span style="color:#032F62;">&quot;fulfilled&quot;</span><span style="color:#24292E;">);</span></span>
<span class="line"></span>
<span class="line"><span style="color:#24292E;">  </span><span style="color:#D73A49;">const</span><span style="color:#24292E;"> </span><span style="color:#005CC5;">pending</span><span style="color:#24292E;"> </span><span style="color:#D73A49;">=</span><span style="color:#24292E;"> </span><span style="color:#D73A49;">new</span><span style="color:#24292E;"> </span><span style="color:#005CC5;">Promise</span><span style="color:#24292E;">(() </span><span style="color:#D73A49;">=&gt;</span><span style="color:#24292E;"> {});</span></span>
<span class="line"><span style="color:#24292E;">  </span><span style="color:#6F42C1;">expect</span><span style="color:#24292E;">(peek.</span><span style="color:#6F42C1;">status</span><span style="color:#24292E;">(pending)).</span><span style="color:#6F42C1;">toBe</span><span style="color:#24292E;">(</span><span style="color:#032F62;">&quot;pending&quot;</span><span style="color:#24292E;">);</span></span>
<span class="line"></span>
<span class="line"><span style="color:#24292E;">  </span><span style="color:#D73A49;">const</span><span style="color:#24292E;"> </span><span style="color:#005CC5;">rejected</span><span style="color:#24292E;"> </span><span style="color:#D73A49;">=</span><span style="color:#24292E;"> </span><span style="color:#005CC5;">Promise</span><span style="color:#24292E;">.</span><span style="color:#6F42C1;">reject</span><span style="color:#24292E;">(</span><span style="color:#D73A49;">new</span><span style="color:#24292E;"> </span><span style="color:#6F42C1;">Error</span><span style="color:#24292E;">(</span><span style="color:#032F62;">&quot;哦不&quot;</span><span style="color:#24292E;">));</span></span>
<span class="line"><span style="color:#24292E;">  </span><span style="color:#6F42C1;">expect</span><span style="color:#24292E;">(peek.</span><span style="color:#6F42C1;">status</span><span style="color:#24292E;">(rejected)).</span><span style="color:#6F42C1;">toBe</span><span style="color:#24292E;">(</span><span style="color:#032F62;">&quot;rejected&quot;</span><span style="color:#24292E;">);</span></span>
<span class="line"><span style="color:#24292E;">});</span></span></code></pre></div><h2 id="bun-openineditor" tabindex="-1"><code>Bun.openInEditor()</code> <a class="header-anchor" href="#bun-openineditor" aria-label="Permalink to &quot;`Bun.openInEditor()`&quot;">​</a></h2><p>在默认编辑器中打开文件。Bun 通过 <code>$VISUAL</code> 或 <code>$EDITOR</code> 环境变量自动检测你的编辑器。</p><div class="language-ts vp-adaptive-theme"><button title="Copy Code" class="copy"></button><span class="lang">ts</span><pre class="shiki github-dark vp-code-dark"><code><span class="line"><span style="color:#F97583;">const</span><span style="color:#E1E4E8;"> </span><span style="color:#79B8FF;">当前文件</span><span style="color:#E1E4E8;"> </span><span style="color:#F97583;">=</span><span style="color:#E1E4E8;"> </span><span style="color:#F97583;">import</span><span style="color:#E1E4E8;">.</span><span style="color:#79B8FF;">meta</span><span style="color:#E1E4E8;">.url;</span></span>
<span class="line"><span style="color:#E1E4E8;">Bun.</span><span style="color:#B392F0;">openInEditor</span><span style="color:#E1E4E8;">(当前文件);</span></span></code></pre><pre class="shiki github-light vp-code-light"><code><span class="line"><span style="color:#D73A49;">const</span><span style="color:#24292E;"> </span><span style="color:#005CC5;">当前文件</span><span style="color:#24292E;"> </span><span style="color:#D73A49;">=</span><span style="color:#24292E;"> </span><span style="color:#D73A49;">import</span><span style="color:#24292E;">.</span><span style="color:#005CC5;">meta</span><span style="color:#24292E;">.url;</span></span>
<span class="line"><span style="color:#24292E;">Bun.</span><span style="color:#6F42C1;">openInEditor</span><span style="color:#24292E;">(当前文件);</span></span></code></pre></div><p>你可以通过 <code>bunfig.toml</code> 中的 <code>debug.editor</code> 设置来覆盖这一点。</p><div class="language-toml-diff#bunfig.toml vp-adaptive-theme"><button title="Copy Code" class="copy"></button><span class="lang">toml-diff#bunfig.toml</span><pre class="shiki github-dark vp-code-dark"><code><span class="line"><span style="color:#e1e4e8;">+ [debug]</span></span>
<span class="line"><span style="color:#e1e4e8;">+ editor = &quot;code&quot;</span></span></code></pre><pre class="shiki github-light vp-code-light"><code><span class="line"><span style="color:#24292e;">+ [debug]</span></span>
<span class="line"><span style="color:#24292e;">+ editor = &quot;code&quot;</span></span></code></pre></div><p>或者使用 <code>editor</code> 参数指定一个编辑器。你还可以指定行号和列号。</p><div class="language-ts vp-adaptive-theme"><button title="Copy Code" class="copy"></button><span class="lang">ts</span><pre class="shiki github-dark vp-code-dark"><code><span class="line"><span style="color:#E1E4E8;">Bun.</span><span style="color:#B392F0;">openInEditor</span><span style="color:#E1E4E8;">(</span><span style="color:#F97583;">import</span><span style="color:#E1E4E8;">.</span><span style="color:#79B8FF;">meta</span><span style="color:#E1E4E8;">.url, {</span></span>
<span class="line"><span style="color:#E1E4E8;">  editor: </span><span style="color:#9ECBFF;">&quot;vscode&quot;</span><span style="color:#E1E4E8;">, </span><span style="color:#6A737D;">// 或 &quot;subl&quot;</span></span>
<span class="line"><span style="color:#E1E4E8;">  line: </span><span style="color:#79B8FF;">10</span><span style="color:#E1E4E8;">,</span></span>
<span class="line"><span style="color:#E1E4E8;">  column: </span><span style="color:#79B8FF;">5</span><span style="color:#E1E4E8;">,</span></span>
<span class="line"><span style="color:#E1E4E8;">});</span></span></code></pre><pre class="shiki github-light vp-code-light"><code><span class="line"><span style="color:#24292E;">Bun.</span><span style="color:#6F42C1;">openInEditor</span><span style="color:#24292E;">(</span><span style="color:#D73A49;">import</span><span style="color:#24292E;">.</span><span style="color:#005CC5;">meta</span><span style="color:#24292E;">.url, {</span></span>
<span class="line"><span style="color:#24292E;">  editor: </span><span style="color:#032F62;">&quot;vscode&quot;</span><span style="color:#24292E;">, </span><span style="color:#6A737D;">// 或 &quot;subl&quot;</span></span>
<span class="line"><span style="color:#24292E;">  line: </span><span style="color:#005CC5;">10</span><span style="color:#24292E;">,</span></span>
<span class="line"><span style="color:#24292E;">  column: </span><span style="color:#005CC5;">5</span><span style="color:#24292E;">,</span></span>
<span class="line"><span style="color:#24292E;">});</span></span></code></pre></div><h2 id="bun-arraybuffersink" tabindex="-1"><code>Bun.ArrayBufferSink</code> <a class="header-anchor" href="#bun-arraybuffersink" aria-label="Permalink to &quot;`Bun.ArrayBufferSink`&quot;">​</a></h2><h2 id="bun-deepequals" tabindex="-1"><code>Bun.deepEquals()</code> <a class="header-anchor" href="#bun-deepequals" aria-label="Permalink to &quot;`Bun.deepEquals()`&quot;">​</a></h2><p>递归检查两个对象是否等价。这在 <code>bun:test</code> 中的 <code>expect().toEqual()</code> 内部使用。</p><div class="language-ts vp-adaptive-theme"><button title="Copy Code" class="copy"></button><span class="lang">ts</span><pre class="shiki github-dark vp-code-dark"><code><span class="line"><span style="color:#F97583;">const</span><span style="color:#E1E4E8;"> </span><span style="color:#79B8FF;">foo</span><span style="color:#E1E4E8;"> </span><span style="color:#F97583;">=</span><span style="color:#E1E4E8;"> { a: </span><span style="color:#79B8FF;">1</span><span style="color:#E1E4E8;">, b: </span><span style="color:#79B8FF;">2</span><span style="color:#E1E4E8;">, c: { d: </span><span style="color:#79B8FF;">3</span><span style="color:#E1E4E8;"> } };</span></span>
<span class="line"></span>
<span class="line"><span style="color:#6A737D;">// true</span></span>
<span class="line"><span style="color:#E1E4E8;">Bun.</span><span style="color:#B392F0;">deepEquals</span><span style="color:#E1E4E8;">(foo, { a: </span><span style="color:#79B8FF;">1</span><span style="color:#E1E4E8;">, b: </span><span style="color:#79B8FF;">2</span><span style="color:#E1E4E8;">, c: { d: </span><span style="color:#79B8FF;">3</span><span style="color:#E1E4E8;"> } });</span></span>
<span class="line"></span>
<span class="line"><span style="color:#6A737D;">// false</span></span>
<span class="line"><span style="color:#E1E4E8;">Bun.</span><span style="color:#B392F0;">deepEquals</span><span style="color:#E1E4E8;">(foo, { a: </span><span style="color:#79B8FF;">1</span><span style="color:#E1E4E8;">, b: </span><span style="color:#79B8FF;">2</span><span style="color:#E1E4E8;">, c: { d: </span><span style="color:#79B8FF;">4</span><span style="color:#E1E4E8;"> } });</span></span></code></pre><pre class="shiki github-light vp-code-light"><code><span class="line"><span style="color:#D73A49;">const</span><span style="color:#24292E;"> </span><span style="color:#005CC5;">foo</span><span style="color:#24292E;"> </span><span style="color:#D73A49;">=</span><span style="color:#24292E;"> { a: </span><span style="color:#005CC5;">1</span><span style="color:#24292E;">, b: </span><span style="color:#005CC5;">2</span><span style="color:#24292E;">, c: { d: </span><span style="color:#005CC5;">3</span><span style="color:#24292E;"> } };</span></span>
<span class="line"></span>
<span class="line"><span style="color:#6A737D;">// true</span></span>
<span class="line"><span style="color:#24292E;">Bun.</span><span style="color:#6F42C1;">deepEquals</span><span style="color:#24292E;">(foo, { a: </span><span style="color:#005CC5;">1</span><span style="color:#24292E;">, b: </span><span style="color:#005CC5;">2</span><span style="color:#24292E;">, c: { d: </span><span style="color:#005CC5;">3</span><span style="color:#24292E;"> } });</span></span>
<span class="line"></span>
<span class="line"><span style="color:#6A737D;">// false</span></span>
<span class="line"><span style="color:#24292E;">Bun.</span><span style="color:#6F42C1;">deepEquals</span><span style="color:#24292E;">(foo, { a: </span><span style="color:#005CC5;">1</span><span style="color:#24292E;">, b: </span><span style="color:#005CC5;">2</span><span style="color:#24292E;">, c: { d: </span><span style="color:#005CC5;">4</span><span style="color:#24292E;"> } });</span></span></code></pre></div><p>可以使用第三个布尔参数启用 &quot;strict&quot; 模式。这由测试运行器中的 <code>expect().toStrictEqual()</code> 使用。</p><div class="language-ts vp-adaptive-theme"><button title="Copy Code" class="copy"></button><span class="lang">ts</span><pre class="shiki github-dark vp-code-dark"><code><span class="line"><span style="color:#F97583;">const</span><span style="color:#E1E4E8;"> </span><span style="color:#79B8FF;">a</span><span style="color:#E1E4E8;"> </span><span style="color:#F97583;">=</span><span style="color:#E1E4E8;"> { entries: [</span><span style="color:#79B8FF;">1</span><span style="color:#E1E4E8;">, </span><span style="color:#79B8FF;">2</span><span style="color:#E1E4E8;">] };</span></span>
<span class="line"><span style="color:#F97583;">const</span><span style="color:#E1E4E8;"> </span><span style="color:#79B8FF;">b</span><span style="color:#E1E4E8;"> </span><span style="color:#F97583;">=</span><span style="color:#E1E4E8;"> { entries: [</span><span style="color:#79B8FF;">1</span><span style="color:#E1E4E8;">, </span><span style="color:#79B8FF;">2</span><span style="color:#E1E4E8;">], extra: </span><span style="color:#79B8FF;">undefined</span><span style="color:#E1E4E8;"> };</span></span>
<span class="line"></span>
<span class="line"><span style="color:#E1E4E8;">Bun.</span><span style="color:#B392F0;">deepEquals</span><span style="color:#E1E4E8;">(a, b); </span><span style="color:#6A737D;">// =&gt; true</span></span>
<span class="line"><span style="color:#E1E4E8;">Bun.</span><span style="color:#B392F0;">deepEquals</span><span style="color:#E1E4E8;">(a, b, </span><span style="color:#79B8FF;">true</span><span style="color:#E1E4E8;">); </span><span style="color:#6A737D;">// =&gt; false</span></span></code></pre><pre class="shiki github-light vp-code-light"><code><span class="line"><span style="color:#D73A49;">const</span><span style="color:#24292E;"> </span><span style="color:#005CC5;">a</span><span style="color:#24292E;"> </span><span style="color:#D73A49;">=</span><span style="color:#24292E;"> { entries: [</span><span style="color:#005CC5;">1</span><span style="color:#24292E;">, </span><span style="color:#005CC5;">2</span><span style="color:#24292E;">] };</span></span>
<span class="line"><span style="color:#D73A49;">const</span><span style="color:#24292E;"> </span><span style="color:#005CC5;">b</span><span style="color:#24292E;"> </span><span style="color:#D73A49;">=</span><span style="color:#24292E;"> { entries: [</span><span style="color:#005CC5;">1</span><span style="color:#24292E;">, </span><span style="color:#005CC5;">2</span><span style="color:#24292E;">], extra: </span><span style="color:#005CC5;">undefined</span><span style="color:#24292E;"> };</span></span>
<span class="line"></span>
<span class="line"><span style="color:#24292E;">Bun.</span><span style="color:#6F42C1;">deepEquals</span><span style="color:#24292E;">(a, b); </span><span style="color:#6A737D;">// =&gt; true</span></span>
<span class="line"><span style="color:#24292E;">Bun.</span><span style="color:#6F42C1;">deepEquals</span><span style="color:#24292E;">(a, b, </span><span style="color:#005CC5;">true</span><span style="color:#24292E;">); </span><span style="color:#6A737D;">// =&gt; false</span></span></code></pre></div><p>在严格模式下，以下内容被视为不等：</p><div class="language-ts vp-adaptive-theme"><button title="Copy Code" class="copy"></button><span class="lang">ts</span><pre class="shiki github-dark vp-code-dark"><code><span class="line"><span style="color:#6A737D;">// 未定义的值</span></span>
<span class="line"><span style="color:#E1E4E8;">Bun.</span><span style="color:#B392F0;">deepEquals</span><span style="color:#E1E4E8;">({}, { a: </span><span style="color:#79B8FF;">undefined</span><span style="color:#E1E4E8;"> }, </span><span style="color:#79B8FF;">true</span><span style="color:#E1E4E8;">); </span><span style="color:#6A737D;">// false</span></span>
<span class="line"></span>
<span class="line"><span style="color:#6A737D;">// 数组中的 undefined</span></span>
<span class="line"><span style="color:#E1E4E8;">Bun.</span><span style="color:#B392F0;">deepEquals</span><span style="color:#E1E4E8;">([</span><span style="color:#9ECBFF;">&quot;asdf&quot;</span><span style="color:#E1E4E8;">], [</span><span style="color:#9ECBFF;">&quot;asdf&quot;</span><span style="color:#E1E4E8;">, </span><span style="color:#79B8FF;">undefined</span><span style="color:#E1E4E8;">], </span><span style="color:#79B8FF;">true</span><span style="color:#E1E4E8;">); </span><span style="color:#6A737D;">// false</span></span>
<span class="line"></span>
<span class="line"><span style="color:#6A737D;">// 稀疏数组</span></span>
<span class="line"><span style="color:#E1E4E8;">Bun.</span><span style="color:#B392F0;">deepEquals</span><span style="color:#E1E4E8;">([, </span><span style="color:#79B8FF;">1</span><span style="color:#E1E4E8;">], [</span><span style="color:#79B8FF;">undefined</span><span style="color:#E1E4E8;">, </span><span style="color:#79B8FF;">1</span><span style="color:#E1E4E8;">], </span><span style="color:#79B8FF;">true</span><span style="color:#E1E4E8;">); </span><span style="color:#6A737D;">// false</span></span>
<span class="line"></span>
<span class="line"><span style="color:#6A737D;">// 对象字面量与具有相同属性的实例</span></span>
<span class="line"><span style="color:#F97583;">class</span><span style="color:#E1E4E8;"> </span><span style="color:#B392F0;">Foo</span><span style="color:#E1E4E8;"> {</span></span>
<span class="line"><span style="color:#E1E4E8;">  </span><span style="color:#FFAB70;">a</span><span style="color:#E1E4E8;"> </span><span style="color:#F97583;">=</span><span style="color:#E1E4E8;"> </span><span style="color:#79B8FF;">1</span><span style="color:#E1E4E8;">;</span></span>
<span class="line"><span style="color:#E1E4E8;">}</span></span>
<span class="line"><span style="color:#E1E4E8;">Bun.</span><span style="color:#B392F0;">deepEquals</span><span style="color:#E1E4E8;">(</span><span style="color:#F97583;">new</span><span style="color:#E1E4E8;"> </span><span style="color:#B392F0;">Foo</span><span style="color:#E1E4E8;">(), { a: </span><span style="color:#79B8FF;">1</span><span style="color:#E1E4E8;"> }, </span><span style="color:#79B8FF;">true</span><span style="color:#E1E4E8;">); </span><span style="color:#6A737D;">// false</span></span></code></pre><pre class="shiki github-light vp-code-light"><code><span class="line"><span style="color:#6A737D;">// 未定义的值</span></span>
<span class="line"><span style="color:#24292E;">Bun.</span><span style="color:#6F42C1;">deepEquals</span><span style="color:#24292E;">({}, { a: </span><span style="color:#005CC5;">undefined</span><span style="color:#24292E;"> }, </span><span style="color:#005CC5;">true</span><span style="color:#24292E;">); </span><span style="color:#6A737D;">// false</span></span>
<span class="line"></span>
<span class="line"><span style="color:#6A737D;">// 数组中的 undefined</span></span>
<span class="line"><span style="color:#24292E;">Bun.</span><span style="color:#6F42C1;">deepEquals</span><span style="color:#24292E;">([</span><span style="color:#032F62;">&quot;asdf&quot;</span><span style="color:#24292E;">], [</span><span style="color:#032F62;">&quot;asdf&quot;</span><span style="color:#24292E;">, </span><span style="color:#005CC5;">undefined</span><span style="color:#24292E;">], </span><span style="color:#005CC5;">true</span><span style="color:#24292E;">); </span><span style="color:#6A737D;">// false</span></span>
<span class="line"></span>
<span class="line"><span style="color:#6A737D;">// 稀疏数组</span></span>
<span class="line"><span style="color:#24292E;">Bun.</span><span style="color:#6F42C1;">deepEquals</span><span style="color:#24292E;">([, </span><span style="color:#005CC5;">1</span><span style="color:#24292E;">], [</span><span style="color:#005CC5;">undefined</span><span style="color:#24292E;">, </span><span style="color:#005CC5;">1</span><span style="color:#24292E;">], </span><span style="color:#005CC5;">true</span><span style="color:#24292E;">); </span><span style="color:#6A737D;">// false</span></span>
<span class="line"></span>
<span class="line"><span style="color:#6A737D;">// 对象字面量与具有相同属性的实例</span></span>
<span class="line"><span style="color:#D73A49;">class</span><span style="color:#24292E;"> </span><span style="color:#6F42C1;">Foo</span><span style="color:#24292E;"> {</span></span>
<span class="line"><span style="color:#24292E;">  </span><span style="color:#E36209;">a</span><span style="color:#24292E;"> </span><span style="color:#D73A49;">=</span><span style="color:#24292E;"> </span><span style="color:#005CC5;">1</span><span style="color:#24292E;">;</span></span>
<span class="line"><span style="color:#24292E;">}</span></span>
<span class="line"><span style="color:#24292E;">Bun.</span><span style="color:#6F42C1;">deepEquals</span><span style="color:#24292E;">(</span><span style="color:#D73A49;">new</span><span style="color:#24292E;"> </span><span style="color:#6F42C1;">Foo</span><span style="color:#24292E;">(), { a: </span><span style="color:#005CC5;">1</span><span style="color:#24292E;"> }, </span><span style="color:#005CC5;">true</span><span style="color:#24292E;">); </span><span style="color:#6A737D;">// false</span></span></code></pre></div><h2 id="bun-escapehtml" tabindex="-1"><code>Bun.escapeHTML()</code> <a class="header-anchor" href="#bun-escapehtml" aria-label="Permalink to &quot;`Bun.escapeHTML()`&quot;">​</a></h2><p><code>Bun.escapeHTML(value: string | object | number | boolean): string</code></p><p>从输入字符串中转义以下字符：</p><ul><li><code>&quot;</code> 变成 <code>&quot;&amp;quot;&quot;</code></li><li><code>&amp;</code> 变成 <code>&quot;&amp;amp;&quot;</code></li><li><code>&#39;</code> 变成 <code>&quot;&amp;#x27;&quot;</code></li><li><code>&lt;</code> 变成 <code>&quot;&amp;lt;&quot;</code></li><li><code>&gt;</code> 变成 <code>&quot;&amp;gt;&quot;</code></li></ul><p>这个函数针对大量输入进行了优化。在 M1X 上，它的处理速度为每秒 480 MB 到 20 GB，取决于正在转义多少数据以及是否有非 ASCII 文本。非字符串类型将在转义之前转换为字符串。</p><h2 id="bun-fileurltopath" tabindex="-1"><code>Bun.fileURLToPath()</code> <a class="header-anchor" href="#bun-fileurltopath" aria-label="Permalink to &quot;`Bun.fileURLToPath()`&quot;">​</a></h2><p>将 <code>file://</code> URL 转换为绝对路径。</p><div class="language-ts vp-adaptive-theme"><button title="Copy Code" class="copy"></button><span class="lang">ts</span><pre class="shiki github-dark vp-code-dark"><code><span class="line"><span style="color:#F97583;">const</span><span style="color:#E1E4E8;"> </span><span style="color:#79B8FF;">path</span><span style="color:#E1E4E8;"> </span><span style="color:#F97583;">=</span><span style="color:#E1E4E8;"> Bun.</span><span style="color:#B392F0;">fileURLToPath</span><span style="color:#E1E4E8;">(</span><span style="color:#F97583;">new</span><span style="color:#E1E4E8;"> </span><span style="color:#B392F0;">URL</span><span style="color:#E1E4E8;">(</span><span style="color:#9ECBFF;">&quot;file:///foo/bar.txt&quot;</span><span style="color:#E1E4E8;">));</span></span>
<span class="line"><span style="color:#E1E4E8;">console.</span><span style="color:#B392F0;">log</span><span style="color:#E1E4E8;">(path); </span><span style="color:#6A737D;">// &quot;/foo/bar.txt&quot;</span></span></code></pre><pre class="shiki github-light vp-code-light"><code><span class="line"><span style="color:#D73A49;">const</span><span style="color:#24292E;"> </span><span style="color:#005CC5;">path</span><span style="color:#24292E;"> </span><span style="color:#D73A49;">=</span><span style="color:#24292E;"> Bun.</span><span style="color:#6F42C1;">fileURLToPath</span><span style="color:#24292E;">(</span><span style="color:#D73A49;">new</span><span style="color:#24292E;"> </span><span style="color:#6F42C1;">URL</span><span style="color:#24292E;">(</span><span style="color:#032F62;">&quot;file:///foo/bar.txt&quot;</span><span style="color:#24292E;">));</span></span>
<span class="line"><span style="color:#24292E;">console.</span><span style="color:#6F42C1;">log</span><span style="color:#24292E;">(path); </span><span style="color:#6A737D;">// &quot;/foo/bar.txt&quot;</span></span></code></pre></div><h2 id="bun-pathtofileurl" tabindex="-1"><code>Bun.pathToFileURL()</code> <a class="header-anchor" href="#bun-pathtofileurl" aria-label="Permalink to &quot;`Bun.pathToFileURL()`&quot;">​</a></h2><p>将绝对路径转换为 <code>file://</code> URL。</p><div class="language-ts vp-adaptive-theme"><button title="Copy Code" class="copy"></button><span class="lang">ts</span><pre class="shiki github-dark vp-code-dark"><code><span class="line"><span style="color:#F97583;">const</span><span style="color:#E1E4E8;"> </span><span style="color:#79B8FF;">url</span><span style="color:#E1E4E8;"> </span><span style="color:#F97583;">=</span><span style="color:#E1E4E8;"> Bun.</span><span style="color:#B392F0;">pathToFileURL</span><span style="color:#E1E4E8;">(</span><span style="color:#9ECBFF;">&quot;/foo/bar.txt&quot;</span><span style="color:#E1E4E8;">);</span></span>
<span class="line"><span style="color:#E1E4E8;">console.</span><span style="color:#B392F0;">log</span><span style="color:#E1E4E8;">(url); </span><span style="color:#6A737D;">// &quot;file:///foo/bar.txt&quot;</span></span></code></pre><pre class="shiki github-light vp-code-light"><code><span class="line"><span style="color:#D73A49;">const</span><span style="color:#24292E;"> </span><span style="color:#005CC5;">url</span><span style="color:#24292E;"> </span><span style="color:#D73A49;">=</span><span style="color:#24292E;"> Bun.</span><span style="color:#6F42C1;">pathToFileURL</span><span style="color:#24292E;">(</span><span style="color:#032F62;">&quot;/foo/bar.txt&quot;</span><span style="color:#24292E;">);</span></span>
<span class="line"><span style="color:#24292E;">console.</span><span style="color:#6F42C1;">log</span><span style="color:#24292E;">(url); </span><span style="color:#6A737D;">// &quot;file:///foo/bar.txt&quot;</span></span></code></pre></div><h2 id="bun-gzipsync" tabindex="-1"><code>Bun.gzipSync()</code> <a class="header-anchor" href="#bun-gzipsync" aria-label="Permalink to &quot;`Bun.gzipSync()`&quot;">​</a></h2><p>使用 zlib 的 GZIP 算法压缩 <code>Uint8Array</code>。</p><div class="language-ts vp-adaptive-theme"><button title="Copy Code" class="copy"></button><span class="lang">ts</span><pre class="shiki github-dark vp-code-dark"><code><span class="line"><span style="color:#F97583;">const</span><span style="color:#E1E4E8;"> </span><span style="color:#79B8FF;">buf</span><span style="color:#E1E4E8;"> </span><span style="color:#F97583;">=</span><span style="color:#E1E4E8;"> Buffer.</span><span style="color:#B392F0;">from</span><span style="color:#E1E4E8;">(</span><span style="color:#9ECBFF;">&quot;hello&quot;</span><span style="color:#E1E4E8;">.</span><span style="color:#B392F0;">repeat</span><span style="color:#E1E4E8;">(</span><span style="color:#79B8FF;">100</span><span style="color:#E1E4E8;">)); </span><span style="color:#6A737D;">// Buffer 扩展 Uint8Array</span></span>
<span class="line"><span style="color:#F97583;">const</span><span style="color:#E1E4E8;"> </span><span style="color:#79B8FF;">compressed</span><span style="color:#E1E4E8;"> </span><span style="color:#F97583;">=</span><span style="color:#E1E4E8;"> Bun.</span><span style="color:#B392F0;">gzipSync</span><span style="color:#E1E4E8;">(buf);</span></span>
<span class="line"></span>
<span class="line"><span style="color:#E1E4E8;">buf; </span><span style="color:#6A737D;">// =&gt; Uint8Array(500)</span></span>
<span class="line"><span style="color:#E1E4E8;">compressed; </span><span style="color:#6A737D;">// =&gt; Uint8Array(30)</span></span></code></pre><pre class="shiki github-light vp-code-light"><code><span class="line"><span style="color:#D73A49;">const</span><span style="color:#24292E;"> </span><span style="color:#005CC5;">buf</span><span style="color:#24292E;"> </span><span style="color:#D73A49;">=</span><span style="color:#24292E;"> Buffer.</span><span style="color:#6F42C1;">from</span><span style="color:#24292E;">(</span><span style="color:#032F62;">&quot;hello&quot;</span><span style="color:#24292E;">.</span><span style="color:#6F42C1;">repeat</span><span style="color:#24292E;">(</span><span style="color:#005CC5;">100</span><span style="color:#24292E;">)); </span><span style="color:#6A737D;">// Buffer 扩展 Uint8Array</span></span>
<span class="line"><span style="color:#D73A49;">const</span><span style="color:#24292E;"> </span><span style="color:#005CC5;">compressed</span><span style="color:#24292E;"> </span><span style="color:#D73A49;">=</span><span style="color:#24292E;"> Bun.</span><span style="color:#6F42C1;">gzipSync</span><span style="color:#24292E;">(buf);</span></span>
<span class="line"></span>
<span class="line"><span style="color:#24292E;">buf; </span><span style="color:#6A737D;">// =&gt; Uint8Array(500)</span></span>
<span class="line"><span style="color:#24292E;">compressed; </span><span style="color:#6A737D;">// =&gt; Uint8Array(30)</span></span></code></pre></div><p>可选地，作为第二个参数传递一个参数对象：</p><details><summary>zlib 压缩选项</summary> ```ts export type ZlibCompressionOptions = { /** * 要使用的压缩级别。必须在 `-1` 和 `9` 之间。 * - `-1` 使用默认压缩级别（当前为 `6`） * - `0` 不压缩 * - `1` 最低压缩，速度最快 * - `9` 最佳压缩，速度最慢 */ level?: -1 | 0 | 1 | 2 | 3 | 4 | 5 | 6 | 7 | 8 | 9; /** * 为内部压缩状态分配的内存量。 * * `1` 使用最少内存，但速度慢且降低了压缩比。 * * `9` 使用最大内存以获得最佳速度。默认值为 `8`。 */ memLevel?: 1 | 2 | 3 | 4 | 5 | 6 | 7 | 8 | 9; /** * 窗口大小的以 2 为底的对数（历史缓冲区的大小）。 * * 较大的值会增加内存使用量，但会提高压缩比。 * * 支持以下值范围： * - `9..15`：输出将具有 zlib 标头和尾部（Deflate） * - `-9..-15`：输出将**不会**具有 zlib 标头或尾部（原始 Deflate） * - `25..31`（16+`9..15`）：输出将具有 gzip 标头和尾部（gzip） * * gzip 标头将不包含文件名、额外数据、注释、修改时间（设置为零）和头部 CRC。 */ windowBits?: | -9 | -10 | -11 | -12 | -13 | -14 | -15 | 9 | 10 | 11 | 12 | 13 | 14 | 15 | 25 | 26 | 27 | 28 | 29 | 30 | 31; /** * 调整压缩算法。 * * - `Z_DEFAULT_STRATEGY`：用于正常数据 **（默认）** * - `Z_FILTERED`：用于由过滤器或预测器生成的数据 * - `Z_HUFFMAN_ONLY`：强制仅使用 Huffman 编码（没有字符串匹配） * - `Z_RLE`：限制匹配距离为一（游程编码） * - `Z_FIXED` 阻止使用动态 Huffman 编码 * * `Z_RLE` 设计得几乎与 `Z_HUFFMAN_ONLY` 一样快，但对于 PNG 图像数据提供更好的压缩。 * * `Z_FILTERED` 强制更多的哈夫曼编码和更少的字符串匹配，它在 `Z_DEFAULT_STRATEGY` 和 `Z_HUFFMAN_ONLY` 之间是中间的。 * 过滤数据主要由小值组成，具有稍微随机的分布。 */ strategy?: number; }; ``` </details><h2 id="bun-gunzipsync" tabindex="-1"><code>Bun.gunzipSync()</code> <a class="header-anchor" href="#bun-gunzipsync" aria-label="Permalink to &quot;`Bun.gunzipSync()`&quot;">​</a></h2><p>使用 zlib 的 GUNZIP 算法解压缩 <code>Uint8Array</code>。</p><div class="language-ts vp-adaptive-theme"><button title="Copy Code" class="copy"></button><span class="lang">ts</span><pre class="shiki github-dark vp-code-dark"><code><span class="line"><span style="color:#F97583;">const</span><span style="color:#E1E4E8;"> </span><span style="color:#79B8FF;">buf</span><span style="color:#E1E4E8;"> </span><span style="color:#F97583;">=</span><span style="color:#E1E4E8;"> Buffer.</span><span style="color:#B392F0;">from</span><span style="color:#E1E4E8;">(</span><span style="color:#9ECBFF;">&quot;hello&quot;</span><span style="color:#E1E4E8;">.</span><span style="color:#B392F0;">repeat</span><span style="color:#E1E4E8;">(</span><span style="color:#79B8FF;">100</span><span style="color:#E1E4E8;">)); </span><span style="color:#6A737D;">// Buffer 扩展 Uint8</span></span>
<span class="line"></span>
<span class="line"><span style="color:#E1E4E8;">Array;</span></span>
<span class="line"><span style="color:#F97583;">const</span><span style="color:#E1E4E8;"> </span><span style="color:#79B8FF;">compressed</span><span style="color:#E1E4E8;"> </span><span style="color:#F97583;">=</span><span style="color:#E1E4E8;"> Bun.</span><span style="color:#B392F0;">gunzipSync</span><span style="color:#E1E4E8;">(buf);</span></span>
<span class="line"></span>
<span class="line"><span style="color:#F97583;">const</span><span style="color:#E1E4E8;"> </span><span style="color:#79B8FF;">dec</span><span style="color:#E1E4E8;"> </span><span style="color:#F97583;">=</span><span style="color:#E1E4E8;"> </span><span style="color:#F97583;">new</span><span style="color:#E1E4E8;"> </span><span style="color:#B392F0;">TextDecoder</span><span style="color:#E1E4E8;">();</span></span>
<span class="line"><span style="color:#F97583;">const</span><span style="color:#E1E4E8;"> </span><span style="color:#79B8FF;">uncompressed</span><span style="color:#E1E4E8;"> </span><span style="color:#F97583;">=</span><span style="color:#E1E4E8;"> Bun.</span><span style="color:#B392F0;">inflateSync</span><span style="color:#E1E4E8;">(compressed);</span></span>
<span class="line"><span style="color:#E1E4E8;">dec.</span><span style="color:#B392F0;">decode</span><span style="color:#E1E4E8;">(uncompressed);</span></span>
<span class="line"><span style="color:#6A737D;">// =&gt; &quot;hellohellohello...&quot;</span></span></code></pre><pre class="shiki github-light vp-code-light"><code><span class="line"><span style="color:#D73A49;">const</span><span style="color:#24292E;"> </span><span style="color:#005CC5;">buf</span><span style="color:#24292E;"> </span><span style="color:#D73A49;">=</span><span style="color:#24292E;"> Buffer.</span><span style="color:#6F42C1;">from</span><span style="color:#24292E;">(</span><span style="color:#032F62;">&quot;hello&quot;</span><span style="color:#24292E;">.</span><span style="color:#6F42C1;">repeat</span><span style="color:#24292E;">(</span><span style="color:#005CC5;">100</span><span style="color:#24292E;">)); </span><span style="color:#6A737D;">// Buffer 扩展 Uint8</span></span>
<span class="line"></span>
<span class="line"><span style="color:#24292E;">Array;</span></span>
<span class="line"><span style="color:#D73A49;">const</span><span style="color:#24292E;"> </span><span style="color:#005CC5;">compressed</span><span style="color:#24292E;"> </span><span style="color:#D73A49;">=</span><span style="color:#24292E;"> Bun.</span><span style="color:#6F42C1;">gunzipSync</span><span style="color:#24292E;">(buf);</span></span>
<span class="line"></span>
<span class="line"><span style="color:#D73A49;">const</span><span style="color:#24292E;"> </span><span style="color:#005CC5;">dec</span><span style="color:#24292E;"> </span><span style="color:#D73A49;">=</span><span style="color:#24292E;"> </span><span style="color:#D73A49;">new</span><span style="color:#24292E;"> </span><span style="color:#6F42C1;">TextDecoder</span><span style="color:#24292E;">();</span></span>
<span class="line"><span style="color:#D73A49;">const</span><span style="color:#24292E;"> </span><span style="color:#005CC5;">uncompressed</span><span style="color:#24292E;"> </span><span style="color:#D73A49;">=</span><span style="color:#24292E;"> Bun.</span><span style="color:#6F42C1;">inflateSync</span><span style="color:#24292E;">(compressed);</span></span>
<span class="line"><span style="color:#24292E;">dec.</span><span style="color:#6F42C1;">decode</span><span style="color:#24292E;">(uncompressed);</span></span>
<span class="line"><span style="color:#6A737D;">// =&gt; &quot;hellohellohello...&quot;</span></span></code></pre></div><h2 id="bun-deflatesync" tabindex="-1"><code>Bun.deflateSync()</code> <a class="header-anchor" href="#bun-deflatesync" aria-label="Permalink to &quot;`Bun.deflateSync()`&quot;">​</a></h2><p>使用 zlib 的 DEFLATE 算法压缩 <code>Uint8Array</code>。</p><div class="language-ts vp-adaptive-theme"><button title="Copy Code" class="copy"></button><span class="lang">ts</span><pre class="shiki github-dark vp-code-dark"><code><span class="line"><span style="color:#F97583;">const</span><span style="color:#E1E4E8;"> </span><span style="color:#79B8FF;">buf</span><span style="color:#E1E4E8;"> </span><span style="color:#F97583;">=</span><span style="color:#E1E4E8;"> Buffer.</span><span style="color:#B392F0;">from</span><span style="color:#E1E4E8;">(</span><span style="color:#9ECBFF;">&quot;hello&quot;</span><span style="color:#E1E4E8;">.</span><span style="color:#B392F0;">repeat</span><span style="color:#E1E4E8;">(</span><span style="color:#79B8FF;">100</span><span style="color:#E1E4E8;">));</span></span>
<span class="line"><span style="color:#F97583;">const</span><span style="color:#E1E4E8;"> </span><span style="color:#79B8FF;">compressed</span><span style="color:#E1E4E8;"> </span><span style="color:#F97583;">=</span><span style="color:#E1E4E8;"> Bun.</span><span style="color:#B392F0;">deflateSync</span><span style="color:#E1E4E8;">(buf);</span></span>
<span class="line"></span>
<span class="line"><span style="color:#E1E4E8;">buf; </span><span style="color:#6A737D;">// =&gt; Uint8Array(25)</span></span>
<span class="line"><span style="color:#E1E4E8;">compressed; </span><span style="color:#6A737D;">// =&gt; Uint8Array(10)</span></span></code></pre><pre class="shiki github-light vp-code-light"><code><span class="line"><span style="color:#D73A49;">const</span><span style="color:#24292E;"> </span><span style="color:#005CC5;">buf</span><span style="color:#24292E;"> </span><span style="color:#D73A49;">=</span><span style="color:#24292E;"> Buffer.</span><span style="color:#6F42C1;">from</span><span style="color:#24292E;">(</span><span style="color:#032F62;">&quot;hello&quot;</span><span style="color:#24292E;">.</span><span style="color:#6F42C1;">repeat</span><span style="color:#24292E;">(</span><span style="color:#005CC5;">100</span><span style="color:#24292E;">));</span></span>
<span class="line"><span style="color:#D73A49;">const</span><span style="color:#24292E;"> </span><span style="color:#005CC5;">compressed</span><span style="color:#24292E;"> </span><span style="color:#D73A49;">=</span><span style="color:#24292E;"> Bun.</span><span style="color:#6F42C1;">deflateSync</span><span style="color:#24292E;">(buf);</span></span>
<span class="line"></span>
<span class="line"><span style="color:#24292E;">buf; </span><span style="color:#6A737D;">// =&gt; Uint8Array(25)</span></span>
<span class="line"><span style="color:#24292E;">compressed; </span><span style="color:#6A737D;">// =&gt; Uint8Array(10)</span></span></code></pre></div><p>第二个参数支持与 <a href="#bun.gzipSync"><code>Bun.gzipSync</code></a> 相同的一组配置选项。</p><h2 id="bun-inflatesync" tabindex="-1"><code>Bun.inflateSync()</code> <a class="header-anchor" href="#bun-inflatesync" aria-label="Permalink to &quot;`Bun.inflateSync()`&quot;">​</a></h2><p>使用 zlib 的 INFLATE 算法解压缩 <code>Uint8Array</code>。</p><div class="language-ts vp-adaptive-theme"><button title="Copy Code" class="copy"></button><span class="lang">ts</span><pre class="shiki github-dark vp-code-dark"><code><span class="line"><span style="color:#F97583;">const</span><span style="color:#E1E4E8;"> </span><span style="color:#79B8FF;">buf</span><span style="color:#E1E4E8;"> </span><span style="color:#F97583;">=</span><span style="color:#E1E4E8;"> Buffer.</span><span style="color:#B392F0;">from</span><span style="color:#E1E4E8;">(</span><span style="color:#9ECBFF;">&quot;hello&quot;</span><span style="color:#E1E4E8;">.</span><span style="color:#B392F0;">repeat</span><span style="color:#E1E4E8;">(</span><span style="color:#79B8FF;">100</span><span style="color:#E1E4E8;">));</span></span>
<span class="line"><span style="color:#F97583;">const</span><span style="color:#E1E4E8;"> </span><span style="color:#79B8FF;">compressed</span><span style="color:#E1E4E8;"> </span><span style="color:#F97583;">=</span><span style="color:#E1E4E8;"> Bun.</span><span style="color:#B392F0;">deflateSync</span><span style="color:#E1E4E8;">(buf);</span></span>
<span class="line"></span>
<span class="line"><span style="color:#F97583;">const</span><span style="color:#E1E4E8;"> </span><span style="color:#79B8FF;">dec</span><span style="color:#E1E4E8;"> </span><span style="color:#F97583;">=</span><span style="color:#E1E4E8;"> </span><span style="color:#F97583;">new</span><span style="color:#E1E4E8;"> </span><span style="color:#B392F0;">TextDecoder</span><span style="color:#E1E4E8;">();</span></span>
<span class="line"><span style="color:#F97583;">const</span><span style="color:#E1E4E8;"> </span><span style="color:#79B8FF;">decompressed</span><span style="color:#E1E4E8;"> </span><span style="color:#F97583;">=</span><span style="color:#E1E4E8;"> Bun.</span><span style="color:#B392F0;">inflateSync</span><span style="color:#E1E4E8;">(compressed);</span></span>
<span class="line"><span style="color:#E1E4E8;">dec.</span><span style="color:#B392F0;">decode</span><span style="color:#E1E4E8;">(decompressed);</span></span>
<span class="line"><span style="color:#6A737D;">// =&gt; &quot;hellohellohello...&quot;</span></span></code></pre><pre class="shiki github-light vp-code-light"><code><span class="line"><span style="color:#D73A49;">const</span><span style="color:#24292E;"> </span><span style="color:#005CC5;">buf</span><span style="color:#24292E;"> </span><span style="color:#D73A49;">=</span><span style="color:#24292E;"> Buffer.</span><span style="color:#6F42C1;">from</span><span style="color:#24292E;">(</span><span style="color:#032F62;">&quot;hello&quot;</span><span style="color:#24292E;">.</span><span style="color:#6F42C1;">repeat</span><span style="color:#24292E;">(</span><span style="color:#005CC5;">100</span><span style="color:#24292E;">));</span></span>
<span class="line"><span style="color:#D73A49;">const</span><span style="color:#24292E;"> </span><span style="color:#005CC5;">compressed</span><span style="color:#24292E;"> </span><span style="color:#D73A49;">=</span><span style="color:#24292E;"> Bun.</span><span style="color:#6F42C1;">deflateSync</span><span style="color:#24292E;">(buf);</span></span>
<span class="line"></span>
<span class="line"><span style="color:#D73A49;">const</span><span style="color:#24292E;"> </span><span style="color:#005CC5;">dec</span><span style="color:#24292E;"> </span><span style="color:#D73A49;">=</span><span style="color:#24292E;"> </span><span style="color:#D73A49;">new</span><span style="color:#24292E;"> </span><span style="color:#6F42C1;">TextDecoder</span><span style="color:#24292E;">();</span></span>
<span class="line"><span style="color:#D73A49;">const</span><span style="color:#24292E;"> </span><span style="color:#005CC5;">decompressed</span><span style="color:#24292E;"> </span><span style="color:#D73A49;">=</span><span style="color:#24292E;"> Bun.</span><span style="color:#6F42C1;">inflateSync</span><span style="color:#24292E;">(compressed);</span></span>
<span class="line"><span style="color:#24292E;">dec.</span><span style="color:#6F42C1;">decode</span><span style="color:#24292E;">(decompressed);</span></span>
<span class="line"><span style="color:#6A737D;">// =&gt; &quot;hellohellohello...&quot;</span></span></code></pre></div><h2 id="bun-inspect" tabindex="-1"><code>Bun.inspect()</code> <a class="header-anchor" href="#bun-inspect" aria-label="Permalink to &quot;`Bun.inspect()`&quot;">​</a></h2><p>将对象序列化为与 <code>console.log</code> 打印的字符串完全相同的 <code>string</code>。</p><div class="language-ts vp-adaptive-theme"><button title="Copy Code" class="copy"></button><span class="lang">ts</span><pre class="shiki github-dark vp-code-dark"><code><span class="line"><span style="color:#F97583;">const</span><span style="color:#E1E4E8;"> </span><span style="color:#79B8FF;">obj</span><span style="color:#E1E4E8;"> </span><span style="color:#F97583;">=</span><span style="color:#E1E4E8;"> { foo: </span><span style="color:#9ECBFF;">&quot;bar&quot;</span><span style="color:#E1E4E8;"> };</span></span>
<span class="line"><span style="color:#F97583;">const</span><span style="color:#E1E4E8;"> </span><span style="color:#79B8FF;">str</span><span style="color:#E1E4E8;"> </span><span style="color:#F97583;">=</span><span style="color:#E1E4E8;"> Bun.</span><span style="color:#B392F0;">inspect</span><span style="color:#E1E4E8;">(obj);</span></span>
<span class="line"><span style="color:#6A737D;">// =&gt; &#39;{\nfoo: &quot;bar&quot; \n}&#39;</span></span>
<span class="line"></span>
<span class="line"><span style="color:#F97583;">const</span><span style="color:#E1E4E8;"> </span><span style="color:#79B8FF;">arr</span><span style="color:#E1E4E8;"> </span><span style="color:#F97583;">=</span><span style="color:#E1E4E8;"> </span><span style="color:#F97583;">new</span><span style="color:#E1E4E8;"> </span><span style="color:#B392F0;">Uint8Array</span><span style="color:#E1E4E8;">([</span><span style="color:#79B8FF;">1</span><span style="color:#E1E4E8;">, </span><span style="color:#79B8FF;">2</span><span style="color:#E1E4E8;">, </span><span style="color:#79B8FF;">3</span><span style="color:#E1E4E8;">]);</span></span>
<span class="line"><span style="color:#F97583;">const</span><span style="color:#E1E4E8;"> </span><span style="color:#79B8FF;">str</span><span style="color:#E1E4E8;"> </span><span style="color:#F97583;">=</span><span style="color:#E1E4E8;"> Bun.</span><span style="color:#B392F0;">inspect</span><span style="color:#E1E4E8;">(arr);</span></span>
<span class="line"><span style="color:#6A737D;">// =&gt; &quot;Uint8Array(3) [ 1, 2, 3 ]&quot;</span></span></code></pre><pre class="shiki github-light vp-code-light"><code><span class="line"><span style="color:#D73A49;">const</span><span style="color:#24292E;"> </span><span style="color:#005CC5;">obj</span><span style="color:#24292E;"> </span><span style="color:#D73A49;">=</span><span style="color:#24292E;"> { foo: </span><span style="color:#032F62;">&quot;bar&quot;</span><span style="color:#24292E;"> };</span></span>
<span class="line"><span style="color:#D73A49;">const</span><span style="color:#24292E;"> </span><span style="color:#005CC5;">str</span><span style="color:#24292E;"> </span><span style="color:#D73A49;">=</span><span style="color:#24292E;"> Bun.</span><span style="color:#6F42C1;">inspect</span><span style="color:#24292E;">(obj);</span></span>
<span class="line"><span style="color:#6A737D;">// =&gt; &#39;{\nfoo: &quot;bar&quot; \n}&#39;</span></span>
<span class="line"></span>
<span class="line"><span style="color:#D73A49;">const</span><span style="color:#24292E;"> </span><span style="color:#005CC5;">arr</span><span style="color:#24292E;"> </span><span style="color:#D73A49;">=</span><span style="color:#24292E;"> </span><span style="color:#D73A49;">new</span><span style="color:#24292E;"> </span><span style="color:#6F42C1;">Uint8Array</span><span style="color:#24292E;">([</span><span style="color:#005CC5;">1</span><span style="color:#24292E;">, </span><span style="color:#005CC5;">2</span><span style="color:#24292E;">, </span><span style="color:#005CC5;">3</span><span style="color:#24292E;">]);</span></span>
<span class="line"><span style="color:#D73A49;">const</span><span style="color:#24292E;"> </span><span style="color:#005CC5;">str</span><span style="color:#24292E;"> </span><span style="color:#D73A49;">=</span><span style="color:#24292E;"> Bun.</span><span style="color:#6F42C1;">inspect</span><span style="color:#24292E;">(arr);</span></span>
<span class="line"><span style="color:#6A737D;">// =&gt; &quot;Uint8Array(3) [ 1, 2, 3 ]&quot;</span></span></code></pre></div><h2 id="bun-inspect-custom" tabindex="-1"><code>Bun.inspect.custom</code> <a class="header-anchor" href="#bun-inspect-custom" aria-label="Permalink to &quot;`Bun.inspect.custom`&quot;">​</a></h2><p>这是 Bun 用于实现 <code>Bun.inspect</code> 的符号。你可以重写它以自定义如何打印你的对象。它与 Node.js 中的 <code>util.inspect.custom</code> 完全相同。</p><div class="language-ts vp-adaptive-theme"><button title="Copy Code" class="copy"></button><span class="lang">ts</span><pre class="shiki github-dark vp-code-dark"><code><span class="line"><span style="color:#F97583;">class</span><span style="color:#E1E4E8;"> </span><span style="color:#B392F0;">Foo</span><span style="color:#E1E4E8;"> {</span></span>
<span class="line"><span style="color:#E1E4E8;">  [Bun.inspect.custom]() {</span></span>
<span class="line"><span style="color:#E1E4E8;">    </span><span style="color:#F97583;">return</span><span style="color:#E1E4E8;"> </span><span style="color:#9ECBFF;">&quot;foo&quot;</span><span style="color:#E1E4E8;">;</span></span>
<span class="line"><span style="color:#E1E4E8;">  }</span></span>
<span class="line"><span style="color:#E1E4E8;">}</span></span>
<span class="line"></span>
<span class="line"><span style="color:#F97583;">const</span><span style="color:#E1E4E8;"> </span><span style="color:#79B8FF;">foo</span><span style="color:#E1E4E8;"> </span><span style="color:#F97583;">=</span><span style="color:#E1E4E8;"> </span><span style="color:#F97583;">new</span><span style="color:#E1E4E8;"> </span><span style="color:#B392F0;">Foo</span><span style="color:#E1E4E8;">();</span></span>
<span class="line"><span style="color:#E1E4E8;">console.</span><span style="color:#B392F0;">log</span><span style="color:#E1E4E8;">(foo); </span><span style="color:#6A737D;">// =&gt; &quot;foo&quot;</span></span></code></pre><pre class="shiki github-light vp-code-light"><code><span class="line"><span style="color:#D73A49;">class</span><span style="color:#24292E;"> </span><span style="color:#6F42C1;">Foo</span><span style="color:#24292E;"> {</span></span>
<span class="line"><span style="color:#24292E;">  [Bun.inspect.custom]() {</span></span>
<span class="line"><span style="color:#24292E;">    </span><span style="color:#D73A49;">return</span><span style="color:#24292E;"> </span><span style="color:#032F62;">&quot;foo&quot;</span><span style="color:#24292E;">;</span></span>
<span class="line"><span style="color:#24292E;">  }</span></span>
<span class="line"><span style="color:#24292E;">}</span></span>
<span class="line"></span>
<span class="line"><span style="color:#D73A49;">const</span><span style="color:#24292E;"> </span><span style="color:#005CC5;">foo</span><span style="color:#24292E;"> </span><span style="color:#D73A49;">=</span><span style="color:#24292E;"> </span><span style="color:#D73A49;">new</span><span style="color:#24292E;"> </span><span style="color:#6F42C1;">Foo</span><span style="color:#24292E;">();</span></span>
<span class="line"><span style="color:#24292E;">console.</span><span style="color:#6F42C1;">log</span><span style="color:#24292E;">(foo); </span><span style="color:#6A737D;">// =&gt; &quot;foo&quot;</span></span></code></pre></div><h2 id="bun-nanoseconds" tabindex="-1"><code>Bun.nanoseconds()</code> <a class="header-anchor" href="#bun-nanoseconds" aria-label="Permalink to &quot;`Bun.nanoseconds()`&quot;">​</a></h2><p>以 <code>number</code> 形式返回自当前 <code>bun</code> 进程启动以来的纳秒数。对于高精度计时和基准测试非常有用。</p><div class="language-ts vp-adaptive-theme"><button title="Copy Code" class="copy"></button><span class="lang">ts</span><pre class="shiki github-dark vp-code-dark"><code><span class="line"><span style="color:#E1E4E8;">Bun.</span><span style="color:#B392F0;">nanoseconds</span><span style="color:#E1E4E8;">();</span></span>
<span class="line"><span style="color:#6A737D;">// =&gt; 7288958</span></span></code></pre><pre class="shiki github-light vp-code-light"><code><span class="line"><span style="color:#24292E;">Bun.</span><span style="color:#6F42C1;">nanoseconds</span><span style="color:#24292E;">();</span></span>
<span class="line"><span style="color:#6A737D;">// =&gt; 7288958</span></span></code></pre></div><h2 id="bun-readablestreamto" tabindex="-1"><code>Bun.readableStreamTo*()</code> <a class="header-anchor" href="#bun-readablestreamto" aria-label="Permalink to &quot;`Bun.readableStreamTo*()`&quot;">​</a></h2><p>Bun 实现了一组用于异步消耗 <code>ReadableStream</code> 主体并将其转换为各种二进制格式的便捷函数。</p><div class="language-ts vp-adaptive-theme"><button title="Copy Code" class="copy"></button><span class="lang">ts</span><pre class="shiki github-dark vp-code-dark"><code><span class="line"><span style="color:#F97583;">const</span><span style="color:#E1E4E8;"> </span><span style="color:#79B8FF;">stream</span><span style="color:#E1E4E8;"> </span><span style="color:#F97583;">=</span><span style="color:#E1E4E8;"> (</span><span style="color:#F97583;">await</span><span style="color:#E1E4E8;"> </span><span style="color:#B392F0;">fetch</span><span style="color:#E1E4E8;">(</span><span style="color:#9ECBFF;">&quot;https://bun.sh&quot;</span><span style="color:#E1E4E8;">)).body;</span></span>
<span class="line"><span style="color:#E1E4E8;">stream; </span><span style="color:#6A737D;">// =&gt; ReadableStream</span></span>
<span class="line"></span>
<span class="line"><span style="color:#F97583;">await</span><span style="color:#E1E4E8;"> Bun.</span><span style="color:#B392F0;">readableStreamToArrayBuffer</span><span style="color:#E1E4E8;">(stream);</span></span>
<span class="line"><span style="color:#6A737D;">// =&gt; ArrayBuffer</span></span>
<span class="line"></span>
<span class="line"><span style="color:#F97583;">await</span><span style="color:#E1E4E8;"> Bun.</span><span style="color:#B392F0;">readableStreamToBlob</span><span style="color:#E1E4E8;">(stream);</span></span>
<span class="line"><span style="color:#6A737D;">// =&gt; Blob</span></span>
<span class="line"></span>
<span class="line"><span style="color:#F97583;">await</span><span style="color:#E1E4E8;"> Bun.</span><span style="color:#B392F0;">readableStreamToJSON</span><span style="color:#E1E4E8;">(stream);</span></span>
<span class="line"><span style="color:#6A737D;">// =&gt; object</span></span>
<span class="line"></span>
<span class="line"><span style="color:#F97583;">await</span><span style="color:#E1E4E8;"> Bun.</span><span style="color:#B392F0;">readableStreamToText</span><span style="color:#E1E4E8;">(stream);</span></span>
<span class="line"><span style="color:#6A737D;">// =&gt; string</span></span>
<span class="line"></span>
<span class="line"><span style="color:#6A737D;">// 作为数组返回所有块</span></span>
<span class="line"><span style="color:#F97583;">await</span><span style="color:#E1E4E8;"> Bun.</span><span style="color:#B392F0;">readableStreamToArray</span><span style="color:#E1E4E8;">(stream);</span></span>
<span class="line"><span style="color:#6A737D;">// =&gt; unknown[]</span></span>
<span class="line"></span>
<span class="line"><span style="color:#6A737D;">// 作为 FormData 对象返回所有块（编码为 x-www-form-urlencoded）</span></span>
<span class="line"><span style="color:#F97583;">await</span><span style="color:#E1E4E8;"> Bun.</span><span style="color:#B392F0;">readableStreamToFormData</span><span style="color:#E1E4E8;">(stream);</span></span>
<span class="line"></span>
<span class="line"><span style="color:#6A737D;">// 作为 FormData 对象返回所有块（编码为 multipart/form-data）</span></span>
<span class="line"><span style="color:#F97583;">await</span><span style="color:#E1E4E8;"> Bun.</span><span style="color:#B392F0;">readableStreamToFormData</span><span style="color:#E1E4E8;">(stream, multipartFormBoundary);</span></span></code></pre><pre class="shiki github-light vp-code-light"><code><span class="line"><span style="color:#D73A49;">const</span><span style="color:#24292E;"> </span><span style="color:#005CC5;">stream</span><span style="color:#24292E;"> </span><span style="color:#D73A49;">=</span><span style="color:#24292E;"> (</span><span style="color:#D73A49;">await</span><span style="color:#24292E;"> </span><span style="color:#6F42C1;">fetch</span><span style="color:#24292E;">(</span><span style="color:#032F62;">&quot;https://bun.sh&quot;</span><span style="color:#24292E;">)).body;</span></span>
<span class="line"><span style="color:#24292E;">stream; </span><span style="color:#6A737D;">// =&gt; ReadableStream</span></span>
<span class="line"></span>
<span class="line"><span style="color:#D73A49;">await</span><span style="color:#24292E;"> Bun.</span><span style="color:#6F42C1;">readableStreamToArrayBuffer</span><span style="color:#24292E;">(stream);</span></span>
<span class="line"><span style="color:#6A737D;">// =&gt; ArrayBuffer</span></span>
<span class="line"></span>
<span class="line"><span style="color:#D73A49;">await</span><span style="color:#24292E;"> Bun.</span><span style="color:#6F42C1;">readableStreamToBlob</span><span style="color:#24292E;">(stream);</span></span>
<span class="line"><span style="color:#6A737D;">// =&gt; Blob</span></span>
<span class="line"></span>
<span class="line"><span style="color:#D73A49;">await</span><span style="color:#24292E;"> Bun.</span><span style="color:#6F42C1;">readableStreamToJSON</span><span style="color:#24292E;">(stream);</span></span>
<span class="line"><span style="color:#6A737D;">// =&gt; object</span></span>
<span class="line"></span>
<span class="line"><span style="color:#D73A49;">await</span><span style="color:#24292E;"> Bun.</span><span style="color:#6F42C1;">readableStreamToText</span><span style="color:#24292E;">(stream);</span></span>
<span class="line"><span style="color:#6A737D;">// =&gt; string</span></span>
<span class="line"></span>
<span class="line"><span style="color:#6A737D;">// 作为数组返回所有块</span></span>
<span class="line"><span style="color:#D73A49;">await</span><span style="color:#24292E;"> Bun.</span><span style="color:#6F42C1;">readableStreamToArray</span><span style="color:#24292E;">(stream);</span></span>
<span class="line"><span style="color:#6A737D;">// =&gt; unknown[]</span></span>
<span class="line"></span>
<span class="line"><span style="color:#6A737D;">// 作为 FormData 对象返回所有块（编码为 x-www-form-urlencoded）</span></span>
<span class="line"><span style="color:#D73A49;">await</span><span style="color:#24292E;"> Bun.</span><span style="color:#6F42C1;">readableStreamToFormData</span><span style="color:#24292E;">(stream);</span></span>
<span class="line"></span>
<span class="line"><span style="color:#6A737D;">// 作为 FormData 对象返回所有块（编码为 multipart/form-data）</span></span>
<span class="line"><span style="color:#D73A49;">await</span><span style="color:#24292E;"> Bun.</span><span style="color:#6F42C1;">readableStreamToFormData</span><span style="color:#24292E;">(stream, multipartFormBoundary);</span></span></code></pre></div><h2 id="bun-resolvesync" tabindex="-1"><code>Bun.resolveSync()</code> <a class="header-anchor" href="#bun-resolvesync" aria-label="Permalink to &quot;`Bun.resolveSync()`&quot;">​</a></h2><p>使用 Bun 的内部模块解析算法解析文件路径或模块规范符号。第一个参数是要解析的路径，第二个参数是 &quot;root&quot;。如果找不到匹配项，将抛出一个 <code>Error</code>。</p><div class="language-ts vp-adaptive-theme"><button title="Copy Code" class="copy"></button><span class="lang">ts</span><pre class="shiki github-dark vp-code-dark"><code><span class="line"><span style="color:#E1E4E8;">Bun.</span><span style="color:#B392F0;">resolveSync</span><span style="color:#E1E4E8;">(</span><span style="color:#9ECBFF;">&quot;./foo.ts&quot;</span><span style="color:#E1E4E8;">, </span><span style="color:#9ECBFF;">&quot;/path/to/project&quot;</span><span style="color:#E1E4E8;">);</span></span>
<span class="line"><span style="color:#6A737D;">// =&gt; &quot;/path/to/project/foo.ts&quot;</span></span>
<span class="line"></span>
<span class="line"><span style="color:#E1E4E8;">Bun.</span><span style="color:#B392F0;">resolveSync</span><span style="color:#E1E4E8;">(</span><span style="color:#9ECBFF;">&quot;zod&quot;</span><span style="color:#E1E4E8;">, </span><span style="color:#9ECBFF;">&quot;/path/to/project&quot;</span><span style="color:#E1E4E8;">);</span></span>
<span class="line"><span style="color:#6A737D;">// =&gt; &quot;/path/to/project/node_modules/zod/index.ts&quot;</span></span></code></pre><pre class="shiki github-light vp-code-light"><code><span class="line"><span style="color:#24292E;">Bun.</span><span style="color:#6F42C1;">resolveSync</span><span style="color:#24292E;">(</span><span style="color:#032F62;">&quot;./foo.ts&quot;</span><span style="color:#24292E;">, </span><span style="color:#032F62;">&quot;/path/to/project&quot;</span><span style="color:#24292E;">);</span></span>
<span class="line"><span style="color:#6A737D;">// =&gt; &quot;/path/to/project/foo.ts&quot;</span></span>
<span class="line"></span>
<span class="line"><span style="color:#24292E;">Bun.</span><span style="color:#6F42C1;">resolveSync</span><span style="color:#24292E;">(</span><span style="color:#032F62;">&quot;zod&quot;</span><span style="color:#24292E;">, </span><span style="color:#032F62;">&quot;/path/to/project&quot;</span><span style="color:#24292E;">);</span></span>
<span class="line"><span style="color:#6A737D;">// =&gt; &quot;/path/to/project/node_modules/zod/index.ts&quot;</span></span></code></pre></div><p>要相对于当前工作目录解析，将 <code>process.cwd</code> 或 <code>&quot;.&quot;</code> 作为根传递。</p><div class="language-ts vp-adaptive-theme"><button title="Copy Code" class="copy"></button><span class="lang">ts</span><pre class="shiki github-dark vp-code-dark"><code><span class="line"><span style="color:#E1E4E8;">Bun.</span><span style="color:#B392F0;">resolveSync</span><span style="color:#E1E4E8;">(</span><span style="color:#9ECBFF;">&quot;./foo.ts&quot;</span><span style="color:#E1E4E8;">, process.</span><span style="color:#B392F0;">cwd</span><span style="color:#E1E4E8;">());</span></span>
<span class="line"><span style="color:#E1E4E8;">Bun.</span><span style="color:#B392F0;">resolveSync</span><span style="color:#E1E4E8;">(</span><span style="color:#9ECBFF;">&quot;./foo.ts&quot;</span><span style="color:#E1E4E8;">, </span><span style="color:#9ECBFF;">&quot;/path/to/project&quot;</span><span style="color:#E1E4E8;">);</span></span></code></pre><pre class="shiki github-light vp-code-light"><code><span class="line"><span style="color:#24292E;">Bun.</span><span style="color:#6F42C1;">resolveSync</span><span style="color:#24292E;">(</span><span style="color:#032F62;">&quot;./foo.ts&quot;</span><span style="color:#24292E;">, process.</span><span style="color:#6F42C1;">cwd</span><span style="color:#24292E;">());</span></span>
<span class="line"><span style="color:#24292E;">Bun.</span><span style="color:#6F42C1;">resolveSync</span><span style="color:#24292E;">(</span><span style="color:#032F62;">&quot;./foo.ts&quot;</span><span style="color:#24292E;">, </span><span style="color:#032F62;">&quot;/path/to/project&quot;</span><span style="color:#24292E;">);</span></span></code></pre></div><p>要相对于包含当前文件的目录解析，传递 <code>i<wbr>mport.meta.dir</code>。</p><div class="language-ts vp-adaptive-theme"><button title="Copy Code" class="copy"></button><span class="lang">ts</span><pre class="shiki github-dark vp-code-dark"><code><span class="line"><span style="color:#E1E4E8;">Bun.</span><span style="color:#B392F0;">resolveSync</span><span style="color:#E1E4E8;">(</span><span style="color:#9ECBFF;">&quot;./foo.ts&quot;</span><span style="color:#E1E4E8;">, </span><span style="color:#F97583;">import</span><span style="color:#E1E4E8;">.</span><span style="color:#79B8FF;">meta</span><span style="color:#E1E4E8;">.dir);</span></span></code></pre><pre class="shiki github-light vp-code-light"><code><span class="line"><span style="color:#24292E;">Bun.</span><span style="color:#6F42C1;">resolveSync</span><span style="color:#24292E;">(</span><span style="color:#032F62;">&quot;./foo.ts&quot;</span><span style="color:#24292E;">, </span><span style="color:#D73A49;">import</span><span style="color:#24292E;">.</span><span style="color:#005CC5;">meta</span><span style="color:#24292E;">.dir);</span></span></code></pre></div><h2 id="bun-jsc-中的-serialize-和-deserialize" tabindex="-1"><code>bun:jsc</code> 中的 <code>serialize</code> 和 <code>deserialize</code> <a class="header-anchor" href="#bun-jsc-中的-serialize-和-deserialize" aria-label="Permalink to &quot;`bun:jsc` 中的 `serialize` 和 `deserialize`&quot;">​</a></h2><p>要将 JavaScript 值保存到 ArrayBuffer 中并恢复，可以使用 <code>&quot;bun:jsc&quot;</code> 模块中的 <code>serialize</code> 和 <code>deserialize</code>。</p><div class="language-js vp-adaptive-theme"><button title="Copy Code" class="copy"></button><span class="lang">js</span><pre class="shiki github-dark vp-code-dark"><code><span class="line"><span style="color:#F97583;">import</span><span style="color:#E1E4E8;"> { serialize, deserialize } </span><span style="color:#F97583;">from</span><span style="color:#E1E4E8;"> </span><span style="color:#9ECBFF;">&quot;bun:jsc&quot;</span><span style="color:#E1E4E8;">;</span></span>
<span class="line"></span>
<span class="line"><span style="color:#F97583;">const</span><span style="color:#E1E4E8;"> </span><span style="color:#79B8FF;">buf</span><span style="color:#E1E4E8;"> </span><span style="color:#F97583;">=</span><span style="color:#E1E4E8;"> </span><span style="color:#B392F0;">serialize</span><span style="color:#E1E4E8;">({ foo: </span><span style="color:#9ECBFF;">&quot;bar&quot;</span><span style="color:#E1E4E8;"> });</span></span>
<span class="line"><span style="color:#F97583;">const</span><span style="color:#E1E4E8;"> </span><span style="color:#79B8FF;">obj</span><span style="color:#E1E4E8;"> </span><span style="color:#F97583;">=</span><span style="color:#E1E4E8;"> </span><span style="color:#B392F0;">deserialize</span><span style="color:#E1E4E8;">(buf);</span></span>
<span class="line"><span style="color:#E1E4E8;">console.</span><span style="color:#B392F0;">log</span><span style="color:#E1E4E8;">(obj); </span><span style="color:#6A737D;">// =&gt; { foo: &quot;bar&quot; }</span></span></code></pre><pre class="shiki github-light vp-code-light"><code><span class="line"><span style="color:#D73A49;">import</span><span style="color:#24292E;"> { serialize, deserialize } </span><span style="color:#D73A49;">from</span><span style="color:#24292E;"> </span><span style="color:#032F62;">&quot;bun:jsc&quot;</span><span style="color:#24292E;">;</span></span>
<span class="line"></span>
<span class="line"><span style="color:#D73A49;">const</span><span style="color:#24292E;"> </span><span style="color:#005CC5;">buf</span><span style="color:#24292E;"> </span><span style="color:#D73A49;">=</span><span style="color:#24292E;"> </span><span style="color:#6F42C1;">serialize</span><span style="color:#24292E;">({ foo: </span><span style="color:#032F62;">&quot;bar&quot;</span><span style="color:#24292E;"> });</span></span>
<span class="line"><span style="color:#D73A49;">const</span><span style="color:#24292E;"> </span><span style="color:#005CC5;">obj</span><span style="color:#24292E;"> </span><span style="color:#D73A49;">=</span><span style="color:#24292E;"> </span><span style="color:#6F42C1;">deserialize</span><span style="color:#24292E;">(buf);</span></span>
<span class="line"><span style="color:#24292E;">console.</span><span style="color:#6F42C1;">log</span><span style="color:#24292E;">(obj); </span><span style="color:#6A737D;">// =&gt; { foo: &quot;bar&quot; }</span></span></code></pre></div><p>在内部，<a href="https://developer.mozilla.org/en-US/docs/Web/API/structuredClone" target="_blank" rel="noreferrer"><code>structuredClone</code></a> 和 <a href="https://developer.mozilla.org/en-US/docs/Web/API/Window/postMessage" target="_blank" rel="noreferrer"><code>postMessage</code></a> 以相同的方式序列化和反序列化。这将 HTML 结构化克隆算法作为 ArrayBuffer 暴露给 JavaScript。</p></div></div></main><footer class="VPDocFooter" data-v-72cf3c1c data-v-f4022e97><!--[--><!--]--><!----><nav class="prev-next" data-v-f4022e97><div class="pager" data-v-f4022e97><a class="pager-link prev" href="/api/test.html" data-v-f4022e97><span class="desc" data-v-f4022e97>Previous page</span><span class="title" data-v-f4022e97>Testing</span></a></div><div class="pager" data-v-f4022e97><a class="pager-link next" href="/api/node-api.html" data-v-f4022e97><span class="desc" data-v-f4022e97>Next page</span><span class="title" data-v-f4022e97>Node-API</span></a></div></nav></footer><!--[--><!--]--></div></div></div><!--[--><!--]--></div></div><!----><!--[--><!--]--></div></div>
    <script>window.__VP_HASH_MAP__=JSON.parse("{\"api_console.md\":\"3f3ec2ff\",\"api_file-system-router.md\":\"cf90877b\",\"api_node-api.md\":\"e27c987b\",\"api_globals.md\":\"05ae97cc\",\"api_workers.md\":\"e1930a4e\",\"what-is-bun.md\":\"b6c69478\",\"test_dom.md\":\"aab1c5c6\",\"api_streams.md\":\"31e10433\",\"api_import-meta.md\":\"0786bf9e\",\"cli_install.md\":\"8ec69da8\",\"bundler_plugins.md\":\"837bfebc\",\"index.md\":\"2f7ea4b2\",\"install_cache.md\":\"48819625\",\"cli_run.md\":\"7f3492d2\",\"bundler_executables.md\":\"87477e3c\",\"api_html-rewriter.md\":\"1a73a29a\",\"bundler_vs-esbuild.md\":\"dbed9590\",\"test_snapshots.md\":\"49469706\",\"runtime_env.md\":\"70ed4b72\",\"test_hot.md\":\"563e581b\",\"api_binary-data.md\":\"f6972991\",\"api_http.md\":\"fe762ffd\",\"runtime_jsx.md\":\"bf4231db\",\"api_websockets.md\":\"6b0b01f4\",\"runtime_web-api.md\":\"1c6f5d95\",\"api_hashing.md\":\"88bd9069\",\"runtime_configuration.md\":\"b5847aba\",\"project_roadmap.md\":\"81e04bc7\",\"bundler_macros.md\":\"db29c3c3\",\"project_licensing.md\":\"fa319684\",\"installation.md\":\"ba26d594\",\"install_registries.md\":\"2f9ac8fa\",\"cli_bunx.md\":\"eee45b67\",\"api_test.md\":\"c2220666\",\"runtime_debugger.md\":\"b44d2ba8\",\"api_tcp.md\":\"617e94a1\",\"runtime_hot.md\":\"a7577b91\",\"api_ffi.md\":\"26454d89\",\"test_lifecycle.md\":\"b906c2ba\",\"install_lockfile.md\":\"ce0da53e\",\"install_utilities.md\":\"049097e2\",\"runtime_typescript.md\":\"6c00cf57\",\"install_workspaces.md\":\"460a5334\",\"quickstart.md\":\"9ffd2ffd\",\"test_coverage.md\":\"c7da10f5\",\"templates.md\":\"2411f628\",\"test_writing.md\":\"1cd7d5e2\",\"runtime_modules.md\":\"c13ecf65\",\"typescript.md\":\"c42ccad8\",\"runtime_bunfig.md\":\"4e243d93\",\"runtime_loaders.md\":\"2b6e2325\",\"bundler_loaders.md\":\"b7867b80\",\"api_file-io.md\":\"dbb78e76\",\"test_mocks.md\":\"adb5327e\",\"project_benchmarking.md\":\"86ebbbd6\",\"test_time.md\":\"5b86b419\",\"runtime_autoimport.md\":\"2b2ca271\",\"cli_test.md\":\"74494eb9\",\"api_transpiler.md\":\"c8d86f86\",\"runtime_nodejs-api.md\":\"8479c99a\",\"runtime_bun-apis.md\":\"fcdb387c\",\"api_utils.md\":\"06822ad6\",\"api_spawn.md\":\"cb15e59d\",\"runtime_plugins.md\":\"dd44781e\",\"api_sqlite.md\":\"e617c511\",\"project_development.md\":\"a8de3363\",\"bundler_index.md\":\"224d93ea\"}");window.__VP_SITE_DATA__=JSON.parse("{\"lang\":\"en-US\",\"dir\":\"ltr\",\"title\":\"Bun 中文文档\",\"description\":\"Bun 中文文档\",\"base\":\"/\",\"head\":[],\"appearance\":true,\"themeConfig\":{\"nav\":[{\"text\":\"Home\",\"link\":\"/\"},{\"text\":\"Docs\",\"link\":\"/what-is-bun\"}],\"sidebar\":[{\"text\":\"Intro-介绍\",\"items\":[{\"text\":\"What is Bun\",\"link\":\"/what-is-bun\"},{\"text\":\"Installation\",\"link\":\"/installation\"},{\"text\":\"Quickstart\",\"link\":\"/quickstart\"},{\"text\":\"TypeScript\",\"link\":\"/typescript\"},{\"text\":\"Templates\",\"link\":\"/templates\"}]},{\"text\":\"Runtime-运行时\",\"items\":[{\"text\":\"bun run\",\"link\":\"/cli/run\"},{\"text\":\"File types\",\"link\":\"/runtime/loaders\"},{\"text\":\"TypeScript\",\"link\":\"/runtime/typescript\"},{\"text\":\"JSX\",\"link\":\"/runtime/jsx\"},{\"text\":\"Environment variables\",\"link\":\"/runtime/env\"},{\"text\":\"Bun APIs\",\"link\":\"/runtime/bun-apis\"},{\"text\":\"Web APIs\",\"link\":\"/runtime/web-api\"},{\"text\":\"Node.js compatibility\",\"link\":\"/runtime/nodejs-api\"},{\"text\":\"Plugins\",\"link\":\"/runtime/plugins\"},{\"text\":\"Watch mode\",\"link\":\"/runtime/hot\"},{\"text\":\"Module resolution\",\"link\":\"/runtime/modules\"},{\"text\":\"Auto-install\",\"link\":\"/runtime/autoimport\"},{\"text\":\"bunfig.toml\",\"link\":\"/runtime/bunfig\"},{\"text\":\"Debugger\",\"link\":\"/runtime/debugger\"}]},{\"text\":\"Package manager\",\"items\":[{\"text\":\"bun install\",\"link\":\"/cli/install\"},{\"text\":\"Global cache\",\"link\":\"/install/cache\"},{\"text\":\"Workspaces\",\"link\":\"/install/workspaces\"},{\"text\":\"Lockfile\",\"link\":\"/install/lockfile\"},{\"text\":\"Scopes and registries\",\"link\":\"/install/registries\"},{\"text\":\"Utilities\",\"link\":\"/install/utilities\"}]},{\"text\":\"Bundler\",\"items\":[{\"text\":\"Bun.build\",\"link\":\"/bundler/index\"},{\"text\":\"Loaders\",\"link\":\"/bundler/loaders\"},{\"text\":\"Plugins\",\"link\":\"/bundler/plugins\"},{\"text\":\"Executables\",\"link\":\"/bundler/executables\"},{\"text\":\"Macros\",\"link\":\"/bundler/macros\"},{\"text\":\"vs esbuild\",\"link\":\"/bundler/vs-esbuild\"}]},{\"text\":\"Test runner\",\"items\":[{\"text\":\"bun test\",\"link\":\"/cli/test\"},{\"text\":\"Writing tests\",\"link\":\"/test/writing\"},{\"text\":\"Watch mode\",\"link\":\"/test/hot\"},{\"text\":\"Lifecycle hooks\",\"link\":\"/test/lifecycle\"},{\"text\":\"Mocks\",\"link\":\"/test/mocks\"},{\"text\":\"Snapshots\",\"link\":\"/test/snapshots\"},{\"text\":\"Dates and times\",\"link\":\"/test/time\"},{\"text\":\"DOM testing\",\"link\":\"/test/dom\"},{\"text\":\"Code coverage\",\"link\":\"/test/coverage\"}]},{\"text\":\"Package runner\",\"items\":[{\"text\":\"bunx\",\"link\":\"/cli/bunx\"}]},{\"text\":\"API\",\"items\":[{\"text\":\"HTTP server\",\"link\":\"/api/http\"},{\"text\":\"WebSockets\",\"link\":\"/api/websockets\"},{\"text\":\"Workers\",\"link\":\"/api/workers\"},{\"text\":\"Binary data\",\"link\":\"/api/binary-data\"},{\"text\":\"Streams\",\"link\":\"/api/streams\"},{\"text\":\"File I/O\",\"link\":\"/api/file-io\"},{\"text\":\"import.meta\",\"link\":\"/api/import-meta\"},{\"text\":\"SQLite\",\"link\":\"/api/sqlite\"},{\"text\":\"FileSystemRouter\",\"link\":\"/api/file-system-router\"},{\"text\":\"TCP sockets\",\"link\":\"/api/tcp\"},{\"text\":\"Globals\",\"link\":\"/api/globals\"},{\"text\":\"Child processes\",\"link\":\"/api/spawn\"},{\"text\":\"Transpiler\",\"link\":\"/api/transpiler\"},{\"text\":\"Hashing\",\"link\":\"/api/hashing\"},{\"text\":\"Console\",\"link\":\"/api/console\"},{\"text\":\"FFI\",\"link\":\"/api/ffi\"},{\"text\":\"HTMLRewriter\",\"link\":\"/api/html-rewriter\"},{\"text\":\"Testing\",\"link\":\"/api/test\"},{\"text\":\"Utils\",\"link\":\"/api/utils\"},{\"text\":\"Node-API\",\"link\":\"/api/node-api\"}]},{\"text\":\"Project\",\"items\":[{\"text\":\"Roadmap\",\"link\":\"/project/roadmap\"},{\"text\":\"Benchmarking\",\"link\":\"/project/benchmarking\"},{\"text\":\"Development\",\"link\":\"/project/development\"},{\"text\":\"License\",\"link\":\"/project/licensing\"}]}]},\"locales\":{},\"scrollOffset\":90,\"cleanUrls\":false}");</script>
    
  </body>
</html>